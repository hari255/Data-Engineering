[0m16:30:12.903302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D0AD290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C8CC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D38CC90>]}


============================== 16:30:12.918826 | 2d2207d7-1620-448c-b2bf-f07462b18aeb ==============================
[0m16:30:12.918826 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:30:12.918826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:30:12.918826 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'custom_postgres'
[0m16:30:12.918826 [debug] [MainThread]: Command `dbt run` failed at 16:30:12.918826 after 0.03 seconds
[0m16:30:12.918826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D21B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D0AD810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C91E690>]}
[0m16:30:12.918826 [debug] [MainThread]: Flushing usage events
[0m16:31:09.756179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B3EDB84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B43C51DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B43E67410>]}


============================== 16:31:09.756179 | c722ee83-b4cb-40d4-8a51-a0921ee50e2a ==============================
[0m16:31:09.756179 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:31:09.756179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m16:31:10.100143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c722ee83-b4cb-40d4-8a51-a0921ee50e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B446707D0>]}
[0m16:31:10.100143 [debug] [MainThread]: Command `dbt clean` succeeded at 16:31:10.100143 after 0.36 seconds
[0m16:31:10.100143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B43D8B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B3D114CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B3D124110>]}
[0m16:31:10.100143 [debug] [MainThread]: Flushing usage events
[0m16:31:22.916392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194264C0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194266C9F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001941F317910>]}


============================== 16:31:22.916392 | fd82fa0f-fe5b-41e6-9719-b266942a1a3d ==============================
[0m16:31:22.916392 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:31:22.916392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:23.026035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd82fa0f-fe5b-41e6-9719-b266942a1a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019426C12A50>]}
[0m16:31:23.026035 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:31:23.026035 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:31:23.026035 [debug] [MainThread]: Command `dbt deps` succeeded at 16:31:23.026035 after 0.13 seconds
[0m16:31:23.041666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019426B9BD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019426B985D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019426B9BB10>]}
[0m16:31:23.041666 [debug] [MainThread]: Flushing usage events
[0m16:31:31.743781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022552CBCAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225529610D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022552BF2350>]}


============================== 16:31:31.759508 | ae4a2863-4917-41d2-9920-80f862c07455 ==============================
[0m16:31:31.759508 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:31:31.759508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:31:31.759508 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'custom_postgres'
[0m16:31:31.759508 [debug] [MainThread]: Command `dbt run` failed at 16:31:31.759508 after 0.03 seconds
[0m16:31:31.759508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225530FFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225530FFB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225530FFDD0>]}
[0m16:31:31.759508 [debug] [MainThread]: Flushing usage events
[0m16:34:54.909188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFBB3642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFBB6A7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFBB372590>]}


============================== 16:34:54.909188 | 77cd927a-c49d-4efe-a145-43f816c06875 ==============================
[0m16:34:54.909188 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:34:54.909188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:54.924856 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'custom_postgres'
[0m16:34:54.924856 [debug] [MainThread]: Command `dbt run` failed at 16:34:54.924856 after 0.02 seconds
[0m16:34:54.924856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFBB322E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFBB367A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFBB383E10>]}
[0m16:34:54.924856 [debug] [MainThread]: Flushing usage events
[0m16:51:23.579366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B449B475D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B449ECC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B449B73B10>]}


============================== 16:51:23.594943 | 9010deeb-c549-4041-85ac-93f6fe6ae589 ==============================
[0m16:51:23.594943 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:51:23.594943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:51:23.724368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9010deeb-c549-4041-85ac-93f6fe6ae589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B449E4BED0>]}
[0m16:51:23.732438 [debug] [MainThread]: Command `dbt clean` succeeded at 16:51:23.732438 after 0.16 seconds
[0m16:51:23.732989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4494A5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B449E2B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44A3933D0>]}
[0m16:51:23.733533 [debug] [MainThread]: Flushing usage events
[0m16:51:36.849628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1C258290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1BAB4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1BD6B3D0>]}


============================== 16:51:36.849628 | dd6555c9-2435-44b2-adb8-ac44850f1219 ==============================
[0m16:51:36.849628 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:51:36.865472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:51:36.865979 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'custom_postgres'
[0m16:51:36.865979 [debug] [MainThread]: Command `dbt run` failed at 16:51:36.865979 after 0.02 seconds
[0m16:51:36.865979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1BB50510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1BB45F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1BAC77D0>]}
[0m16:51:36.865979 [debug] [MainThread]: Flushing usage events
[0m16:52:02.773273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A938345F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A934AB0B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A930EB1DD0>]}


============================== 16:52:02.779280 | a2de1e9f-c877-4292-be99-283b338e3d24 ==============================
[0m16:52:02.779280 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:52:02.780283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:52:02.783275 [info ] [MainThread]: Setting up your profile.
[0m16:53:50.027288 [info ] [MainThread]: Profile custom_postgres written to C:\Users\Harinath\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m16:53:50.027288 [debug] [MainThread]: Command `dbt init` succeeded at 16:53:50.027288 after 107.27 seconds
[0m16:53:50.027288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A938713C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A938219410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A931194090>]}
[0m16:53:50.027288 [debug] [MainThread]: Flushing usage events
[0m16:54:11.640914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81E12AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81DE92510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81E140910>]}


============================== 16:54:11.640914 | 843b1e12-84ff-47b3-8dcf-eea678032808 ==============================
[0m16:54:11.640914 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:54:11.640914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:11.841556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '843b1e12-84ff-47b3-8dcf-eea678032808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81E168A50>]}
[0m16:54:11.904034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '843b1e12-84ff-47b3-8dcf-eea678032808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81DE87A50>]}
[0m16:54:11.919654 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m16:54:11.937896 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:54:11.937896 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:54:11.937896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '843b1e12-84ff-47b3-8dcf-eea678032808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81E168790>]}
[0m16:54:13.814287 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\example\schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier for the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models\\example\\schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m16:54:13.814287 [debug] [MainThread]: Command `dbt run` failed at 16:54:13.814287 after 2.23 seconds
[0m16:54:13.814287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81DE43750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81E15F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81C96AE90>]}
[0m16:54:13.814287 [debug] [MainThread]: Flushing usage events
[0m16:54:43.488106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A2503550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A2503410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A1D55F50>]}


============================== 16:54:43.488106 | df3aa2ca-4a5a-4162-9a7f-48f1e5036cd5 ==============================
[0m16:54:43.488106 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:54:43.488106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:43.604801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df3aa2ca-4a5a-4162-9a7f-48f1e5036cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A250C050>]}
[0m16:54:43.604801 [debug] [MainThread]: Command `dbt clean` succeeded at 16:54:43.604801 after 0.18 seconds
[0m16:54:43.604801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A1F49650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679AF34C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A20200D0>]}
[0m16:54:43.604801 [debug] [MainThread]: Flushing usage events
[0m16:54:52.904021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53D508690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53CDA7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53D364510>]}


============================== 16:54:52.904021 | 7cbe6a72-d102-48cb-bd5a-824a39537f84 ==============================
[0m16:54:52.904021 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:54:52.910369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Harinath\\etl\\custom_postgres\\logs', 'profiles_dir': 'C:\\Users\\Harinath\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:53.105558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cbe6a72-d102-48cb-bd5a-824a39537f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53CD56110>]}
[0m16:54:53.168066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cbe6a72-d102-48cb-bd5a-824a39537f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53E623E90>]}
[0m16:54:53.168066 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m16:54:53.183690 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:54:53.183690 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:54:53.183690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cbe6a72-d102-48cb-bd5a-824a39537f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53E605A50>]}
[0m16:54:53.929541 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\example\schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier for the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models\\example\\schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m16:54:53.929541 [debug] [MainThread]: Command `dbt run` failed at 16:54:53.929541 after 1.07 seconds
[0m16:54:53.929541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53CE27910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53CD72DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53E84C490>]}
[0m16:54:53.929541 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 21:55:19.803316 | 02e773f8-25d0-4312-9f56-467807ee0208 ==============================
[0m21:55:19.803316 [info ] [MainThread]: Running with dbt=1.4.7
[0m21:55:19.806599 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:55:19.807616 [debug] [MainThread]: Tracking: tracking
[0m21:55:19.812335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4adead0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4adead7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4adead390>]}
[0m21:55:19.827751 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m21:55:19.836648 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:55:19.837840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02e773f8-25d0-4312-9f56-467807ee0208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4adead7e0>]}
[0m21:55:20.743946 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m21:55:20.759211 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m21:55:20.765287 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m21:55:20.773994 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m21:55:20.892854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ac5fa860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ac5bf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ac5bdc60>]}
[0m21:55:20.895559 [debug] [MainThread]: Flushing usage events
[0m21:55:22.119392 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.film_ratings' (models/example/film_ratings.sql) depends on a node named 'film_Actors' which was not found


============================== 2024-02-25 22:03:46.474941 | 7eee896d-e51d-40bf-9b8c-c1c55ec47b32 ==============================
[0m22:03:46.474941 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:03:46.477754 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:03:46.479144 [debug] [MainThread]: Tracking: tracking
[0m22:03:46.482869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f86d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f86d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f86d390>]}
[0m22:03:46.495960 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:03:46.506016 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:03:46.507414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7eee896d-e51d-40bf-9b8c-c1c55ec47b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f86d7e0>]}
[0m22:03:47.409913 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m22:03:47.424474 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m22:03:47.429975 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m22:03:47.435993 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m22:03:47.554254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1dfae8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1df6d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1df6d390>]}
[0m22:03:47.556286 [debug] [MainThread]: Flushing usage events
[0m22:03:47.792959 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.film_ratings' (models/example/film_ratings.sql) depends on a node named 'film_Actors' which was not found


============================== 2024-02-25 22:05:43.659798 | 2ab3722b-1edc-4417-ab55-cfe112a4f189 ==============================
[0m22:05:43.659798 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:05:43.662551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:05:43.663488 [debug] [MainThread]: Tracking: tracking
[0m22:05:43.666214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3881f5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3881f57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3881f53c0>]}
[0m22:05:43.680493 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:05:43.691561 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:43.693099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3881f5810>]}
[0m22:05:44.567162 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m22:05:44.582317 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m22:05:44.586795 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m22:05:44.592082 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m22:05:44.766656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa386a6b9d0>]}
[0m22:05:44.822780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3881f5480>]}
[0m22:05:44.826482 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:05:44.829306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa386899810>]}
[0m22:05:44.835134 [info ] [MainThread]: 
[0m22:05:44.840990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:44.846344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:05:44.861164 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:05:44.863014 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:05:44.865023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:44.948514 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:05:44.952249 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:05:44.956115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:05:44.963401 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:05:44.965801 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:05:44.968152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:44.988261 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:05:44.990092 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:05:44.991798 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:05:45.002342 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m22:05:45.005718 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:05:45.009494 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:05:45.016305 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:45.017732 [debug] [MainThread]: On master: BEGIN
[0m22:05:45.019026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:45.040579 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:05:45.041823 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:45.042748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:45.050525 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:05:45.053302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38419b8e0>]}
[0m22:05:45.054782 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:45.057057 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:45.057977 [debug] [MainThread]: On master: BEGIN
[0m22:05:45.061275 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:05:45.062102 [debug] [MainThread]: On master: COMMIT
[0m22:05:45.062837 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:45.063485 [debug] [MainThread]: On master: COMMIT
[0m22:05:45.065731 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:05:45.066775 [debug] [MainThread]: On master: Close
[0m22:05:45.069238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:05:45.072441 [info ] [MainThread]: 
[0m22:05:45.092701 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:05:45.094653 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:05:45.096574 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:05:45.098498 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:05:45.104972 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:05:45.131704 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:05:45.099882 => 2024-02-25 22:05:45.131537
[0m22:05:45.132789 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:05:45.181607 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:05:45.218473 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:05:45.219671 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:05:45.220796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:45.236982 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:05:45.238138 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:05:45.239083 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:05:45.242392 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m22:05:45.243404 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m22:05:45.246096 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:05:45.133908 => 2024-02-25 22:05:45.245999
[0m22:05:45.247170 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:05:45.253649 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:05:45.255168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3868bae60>]}
[0m22:05:45.256611 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.16s]
[0m22:05:45.259093 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:05:45.260531 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:05:45.261753 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:05:45.263275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:05:45.264585 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:05:45.269690 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:05:45.278955 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:05:45.265488 => 2024-02-25 22:05:45.278809
[0m22:05:45.280575 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:05:45.288230 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:05:45.304167 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:05:45.305514 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:05:45.306785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:45.325715 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:05:45.326925 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:05:45.327885 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:05:45.330968 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m22:05:45.331950 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m22:05:45.335102 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:05:45.281692 => 2024-02-25 22:05:45.334729
[0m22:05:45.336370 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:05:45.338482 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:05:45.339989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3869206d0>]}
[0m22:05:45.341229 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m22:05:45.342348 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:05:45.343369 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:05:45.344580 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m22:05:45.346262 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:05:45.347281 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:05:45.351127 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:05:45.360376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:05:45.348291 => 2024-02-25 22:05:45.360224
[0m22:05:45.361570 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:05:45.366769 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:05:45.379678 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:05:45.380817 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:05:45.381700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:45.399085 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:05:45.400308 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:05:45.401700 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:05:45.407104 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m22:05:45.408622 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m22:05:45.411785 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:05:45.362358 => 2024-02-25 22:05:45.411677
[0m22:05:45.412927 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:05:45.415333 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:05:45.416765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab3722b-1edc-4417-ab55-cfe112a4f189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3868b98a0>]}
[0m22:05:45.418373 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m22:05:45.419723 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:05:45.422184 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:05:45.423168 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m22:05:45.424317 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:05:45.427309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:45.428377 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:45.429223 [debug] [MainThread]: On master: BEGIN
[0m22:05:45.430134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:45.447543 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:05:45.448773 [debug] [MainThread]: On master: COMMIT
[0m22:05:45.449796 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:45.450830 [debug] [MainThread]: On master: COMMIT
[0m22:05:45.455016 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:05:45.456276 [debug] [MainThread]: On master: Close
[0m22:05:45.457873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:45.459176 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m22:05:45.461215 [info ] [MainThread]: 
[0m22:05:45.462505 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m22:05:45.463684 [debug] [MainThread]: Command end result
[0m22:05:45.487187 [info ] [MainThread]: 
[0m22:05:45.489075 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:05:45.490230 [info ] [MainThread]: 
[0m22:05:45.491514 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m22:05:45.493279 [error] [MainThread]:   relation "public.actors" does not exist
[0m22:05:45.494833 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m22:05:45.496199 [error] [MainThread]:                             ^
[0m22:05:45.497339 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:05:45.498746 [info ] [MainThread]: 
[0m22:05:45.500047 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m22:05:45.501080 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m22:05:45.502728 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m22:05:45.504358 [error] [MainThread]:                             ^
[0m22:05:45.505813 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:05:45.507041 [info ] [MainThread]: 
[0m22:05:45.508078 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m22:05:45.509126 [error] [MainThread]:   relation "public.films" does not exist
[0m22:05:45.510299 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m22:05:45.511264 [error] [MainThread]:                             ^
[0m22:05:45.512643 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:05:45.513803 [info ] [MainThread]: 
[0m22:05:45.515026 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m22:05:45.516467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa386889570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa384213940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa384213d00>]}
[0m22:05:45.518724 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 22:17:33.150917 | 32268207-6855-4af7-a317-b03bb4e868ac ==============================
[0m22:17:33.150917 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:17:33.154342 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:17:33.156028 [debug] [MainThread]: Tracking: tracking
[0m22:17:33.158880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc619bc4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc619bc6fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc619bc4b20>]}
[0m22:17:33.181536 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:17:33.687826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:33.690605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:33.703171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61827ff70>]}
[0m22:17:33.757622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61823dea0>]}
[0m22:17:33.760920 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:17:33.763682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61823df00>]}
[0m22:17:33.768370 [info ] [MainThread]: 
[0m22:17:33.772889 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:33.776248 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:17:33.790681 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:17:33.793205 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:17:33.795458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:33.825583 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:17:33.828760 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:17:33.832525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:17:33.842424 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:17:33.844813 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:17:33.847222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:33.868968 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:17:33.870188 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:17:33.870935 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:17:33.885496 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m22:17:33.888023 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:17:33.891184 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:17:33.900145 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:33.903216 [debug] [MainThread]: On master: BEGIN
[0m22:17:33.904750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:33.924985 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:33.926509 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:33.928443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:17:33.945346 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:17:33.948173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6182bf850>]}
[0m22:17:33.950611 [debug] [MainThread]: On master: ROLLBACK
[0m22:17:33.954591 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:33.955894 [debug] [MainThread]: On master: BEGIN
[0m22:17:33.960759 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:33.962279 [debug] [MainThread]: On master: COMMIT
[0m22:17:33.963557 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:33.965023 [debug] [MainThread]: On master: COMMIT
[0m22:17:33.970088 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:33.971210 [debug] [MainThread]: On master: Close
[0m22:17:33.973154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:17:33.974548 [info ] [MainThread]: 
[0m22:17:33.979727 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:17:33.980948 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:17:33.984456 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:17:33.985874 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:17:33.989915 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:17:34.010770 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:17:33.986911 => 2024-02-25 22:17:34.010619
[0m22:17:34.012831 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:17:34.062033 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:17:34.090622 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:17:34.092655 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:17:34.094461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:34.117432 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:17:34.118854 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:17:34.119640 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:17:34.135735 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:17:34.143620 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:17:34.145158 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m22:17:34.151120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:17:34.156585 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:17:34.157925 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m22:17:34.163279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:17:34.190395 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:17:34.193364 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:17:34.194515 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:17:34.205021 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:17:34.212882 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:17:34.214734 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m22:17:34.228066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:17:34.232007 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:17:34.014866 => 2024-02-25 22:17:34.231932
[0m22:17:34.234896 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:17:34.238415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6182d9bd0>]}
[0m22:17:34.240486 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.26s]
[0m22:17:34.243474 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:17:34.244816 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:17:34.246343 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:17:34.248172 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:17:34.250209 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:17:34.255039 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:17:34.272954 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:17:34.251960 => 2024-02-25 22:17:34.272811
[0m22:17:34.274892 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:17:34.283076 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:17:34.302993 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:17:34.304121 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:17:34.305069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:34.326005 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:17:34.327251 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:17:34.328502 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:17:34.340756 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:17:34.345826 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:17:34.347283 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m22:17:34.351463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:17:34.355845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:17:34.357068 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m22:17:34.363267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:17:34.368721 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:17:34.371412 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:17:34.374225 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:17:34.383602 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:17:34.387885 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:17:34.389249 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m22:17:34.396754 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:17:34.399376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:17:34.276703 => 2024-02-25 22:17:34.399317
[0m22:17:34.400759 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:17:34.402447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6182bf280>]}
[0m22:17:34.404211 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.15s]
[0m22:17:34.405797 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:17:34.407390 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:17:34.408830 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m22:17:34.410819 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:17:34.411989 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:17:34.417490 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:17:34.433966 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:17:34.413491 => 2024-02-25 22:17:34.433763
[0m22:17:34.437102 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:17:34.443218 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:17:34.474026 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:17:34.477227 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:17:34.479307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:34.505798 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:17:34.507771 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:17:34.508986 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:17:34.522355 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:17:34.527327 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:17:34.528827 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m22:17:34.535779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:17:34.540991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:17:34.542193 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m22:17:34.545792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:17:34.549443 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:17:34.551668 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:17:34.552483 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:17:34.557909 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:17:34.561126 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:17:34.562006 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m22:17:34.570415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:17:34.573304 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:17:34.439075 => 2024-02-25 22:17:34.573230
[0m22:17:34.574626 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:17:34.576324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc618195b40>]}
[0m22:17:34.577741 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.17s]
[0m22:17:34.579079 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:17:34.581421 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:17:34.583363 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m22:17:34.586603 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m22:17:34.588174 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m22:17:34.592858 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m22:17:34.606753 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 22:17:34.589335 => 2024-02-25 22:17:34.606603
[0m22:17:34.607987 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m22:17:34.613189 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m22:17:34.626837 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:17:34.628612 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m22:17:34.629910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:34.649194 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:17:34.650636 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:17:34.652198 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            when user_rating >= 4.5 THEN 'EXCELLENT'
            when user_rating >= 4.0 THEN 'GOOD'
            when user_rating >= 3.0 THEN 'AVERAGE'
            else 'POOR'
        END as rating_category 
    FROM "destination_db"."public"."films"    
)


films_with_actors AS (
    SELECT 
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)


SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m22:17:34.656921 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "films_with_actors"
LINE 26: films_with_actors AS (
         ^

[0m22:17:34.658094 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m22:17:34.660833 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 22:17:34.608868 => 2024-02-25 22:17:34.660670
[0m22:17:34.661705 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m22:17:34.665155 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "films_with_actors"
  LINE 26: films_with_actors AS (
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:17:34.667901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32268207-6855-4af7-a317-b03bb4e868ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61826bd30>]}
[0m22:17:34.669510 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.08s]
[0m22:17:34.670711 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:17:34.673632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:34.674713 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:34.675571 [debug] [MainThread]: On master: BEGIN
[0m22:17:34.676515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:34.692983 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:34.694285 [debug] [MainThread]: On master: COMMIT
[0m22:17:34.695415 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:34.696307 [debug] [MainThread]: On master: COMMIT
[0m22:17:34.700238 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:34.702007 [debug] [MainThread]: On master: Close
[0m22:17:34.703905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:34.704818 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m22:17:34.705798 [info ] [MainThread]: 
[0m22:17:34.707017 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m22:17:34.708205 [debug] [MainThread]: Command end result
[0m22:17:34.732749 [info ] [MainThread]: 
[0m22:17:34.734312 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:17:34.736200 [info ] [MainThread]: 
[0m22:17:34.737449 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m22:17:34.738469 [error] [MainThread]:   syntax error at or near "films_with_actors"
[0m22:17:34.739656 [error] [MainThread]:   LINE 26: films_with_actors AS (
[0m22:17:34.740552 [error] [MainThread]:            ^
[0m22:17:34.741443 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:17:34.742412 [info ] [MainThread]: 
[0m22:17:34.743512 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:17:34.744700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6182c8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6182cb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6182caad0>]}
[0m22:17:34.746217 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 22:27:39.252805 | c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1 ==============================
[0m22:27:39.252805 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:27:39.256175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:27:39.258015 [debug] [MainThread]: Tracking: tracking
[0m22:27:39.260977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967501360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99675017e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99675013c0>]}
[0m22:27:39.289632 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:27:39.722517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:27:39.724412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:27:39.737019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965c3ca30>]}
[0m22:27:39.792206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965b82050>]}
[0m22:27:39.794209 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:27:39.795576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965b820b0>]}
[0m22:27:39.798959 [info ] [MainThread]: 
[0m22:27:39.802562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:39.806397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:27:39.826064 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:27:39.827396 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:27:39.828597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:39.852435 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:27:39.856823 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:27:39.860965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:27:39.869015 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:27:39.871050 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:27:39.872572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:39.888744 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:27:39.889970 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:27:39.891231 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:27:39.898218 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m22:27:39.900638 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:27:39.904289 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:27:39.911423 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:39.912613 [debug] [MainThread]: On master: BEGIN
[0m22:27:39.913658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:39.929761 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:39.930955 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:39.931992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:27:39.941995 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:27:39.944494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965a8b850>]}
[0m22:27:39.945690 [debug] [MainThread]: On master: ROLLBACK
[0m22:27:39.948430 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:39.949702 [debug] [MainThread]: On master: BEGIN
[0m22:27:39.954135 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:39.955794 [debug] [MainThread]: On master: COMMIT
[0m22:27:39.956686 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:39.957790 [debug] [MainThread]: On master: COMMIT
[0m22:27:39.960240 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:27:39.961227 [debug] [MainThread]: On master: Close
[0m22:27:39.962655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:27:39.964626 [info ] [MainThread]: 
[0m22:27:39.984584 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:27:39.985931 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:27:39.988069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:27:39.989792 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:27:39.994003 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:27:40.003794 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:27:39.990630 => 2024-02-25 22:27:40.003622
[0m22:27:40.005202 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:27:40.057389 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:27:40.066604 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:27:40.067720 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:27:40.068926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:40.084620 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:27:40.086295 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:27:40.087809 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:27:40.091015 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m22:27:40.091893 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m22:27:40.094742 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:27:40.006095 => 2024-02-25 22:27:40.094651
[0m22:27:40.095986 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:27:40.098819 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:27:40.099940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965ace890>]}
[0m22:27:40.101106 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m22:27:40.103449 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:27:40.104495 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:27:40.105517 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:27:40.107106 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:27:40.108147 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:27:40.113214 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:27:40.122021 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:27:40.108981 => 2024-02-25 22:27:40.121873
[0m22:27:40.123264 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:27:40.128759 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:27:40.139269 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:27:40.140181 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:27:40.141105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:40.154798 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:27:40.156185 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:27:40.157084 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:27:40.159852 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m22:27:40.160793 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m22:27:40.163215 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:27:40.124403 => 2024-02-25 22:27:40.163129
[0m22:27:40.164055 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:27:40.165630 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:27:40.166718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965af0100>]}
[0m22:27:40.167878 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m22:27:40.168888 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:27:40.169929 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:27:40.170836 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m22:27:40.172182 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:27:40.173016 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:27:40.176610 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:27:40.185467 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:27:40.173679 => 2024-02-25 22:27:40.185338
[0m22:27:40.186694 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:27:40.191489 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:27:40.204472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:27:40.205999 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:27:40.207142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:40.222682 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:27:40.223744 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:27:40.224673 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:27:40.227094 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m22:27:40.227998 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m22:27:40.230459 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:27:40.187414 => 2024-02-25 22:27:40.230370
[0m22:27:40.233032 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:27:40.234765 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:27:40.235890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b5b5c8-5c89-44ee-b9ec-1ec169a1f1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965aced70>]}
[0m22:27:40.237188 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m22:27:40.238298 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:27:40.240365 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:27:40.241497 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m22:27:40.242776 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:27:40.245550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:40.246793 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:40.247608 [debug] [MainThread]: On master: BEGIN
[0m22:27:40.248397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:27:40.263131 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:40.264682 [debug] [MainThread]: On master: COMMIT
[0m22:27:40.266152 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:40.267228 [debug] [MainThread]: On master: COMMIT
[0m22:27:40.269931 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:27:40.270945 [debug] [MainThread]: On master: Close
[0m22:27:40.272434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:40.273350 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m22:27:40.274487 [info ] [MainThread]: 
[0m22:27:40.275557 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m22:27:40.276899 [debug] [MainThread]: Command end result
[0m22:27:40.302136 [info ] [MainThread]: 
[0m22:27:40.303595 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:27:40.305076 [info ] [MainThread]: 
[0m22:27:40.306242 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m22:27:40.307702 [error] [MainThread]:   relation "public.actors" does not exist
[0m22:27:40.308914 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m22:27:40.310479 [error] [MainThread]:                             ^
[0m22:27:40.311638 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:27:40.313107 [info ] [MainThread]: 
[0m22:27:40.314154 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m22:27:40.315485 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m22:27:40.316716 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m22:27:40.317901 [error] [MainThread]:                             ^
[0m22:27:40.318706 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:27:40.319582 [info ] [MainThread]: 
[0m22:27:40.320688 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m22:27:40.321588 [error] [MainThread]:   relation "public.films" does not exist
[0m22:27:40.322495 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m22:27:40.323902 [error] [MainThread]:                             ^
[0m22:27:40.325055 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:27:40.326309 [info ] [MainThread]: 
[0m22:27:40.327861 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m22:27:40.329714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965a8b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965af0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9965af2d70>]}
[0m22:27:40.331379 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 22:29:47.753381 | fe06ecd1-5fec-4e1c-afbc-36fa95df676b ==============================
[0m22:29:47.753381 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:29:47.756552 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:29:47.758228 [debug] [MainThread]: Tracking: tracking
[0m22:29:47.760992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff904a6cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff904a6f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff904a6cb80>]}
[0m22:29:47.780838 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:29:48.259024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:48.261727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:48.271417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903127fa0>]}
[0m22:29:48.323359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9030e5ed0>]}
[0m22:29:48.326599 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:29:48.329432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9030e5f30>]}
[0m22:29:48.335302 [info ] [MainThread]: 
[0m22:29:48.340900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:48.345572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:29:48.363545 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:29:48.366333 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:29:48.370054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:48.399361 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:29:48.404662 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:29:48.409212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:29:48.418102 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:29:48.421153 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:29:48.424021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:48.452309 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:29:48.455684 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:29:48.457503 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:29:48.469682 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m22:29:48.477703 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:29:48.487586 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:29:48.496539 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:48.498501 [debug] [MainThread]: On master: BEGIN
[0m22:29:48.501724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:48.530635 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:29:48.532744 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:48.534056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:29:48.541312 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:29:48.543723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903167850>]}
[0m22:29:48.544936 [debug] [MainThread]: On master: ROLLBACK
[0m22:29:48.548411 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:48.549452 [debug] [MainThread]: On master: BEGIN
[0m22:29:48.560300 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:29:48.563634 [debug] [MainThread]: On master: COMMIT
[0m22:29:48.565595 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:48.567500 [debug] [MainThread]: On master: COMMIT
[0m22:29:48.571722 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:29:48.573094 [debug] [MainThread]: On master: Close
[0m22:29:48.575236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:48.576592 [info ] [MainThread]: 
[0m22:29:48.582891 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:29:48.585716 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:29:48.587803 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:29:48.588646 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:29:48.592440 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:29:48.605440 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:29:48.589452 => 2024-02-25 22:29:48.605221
[0m22:29:48.608265 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:29:48.661390 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:29:48.696139 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:29:48.697746 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:29:48.699978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:48.727949 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:29:48.729309 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:29:48.730313 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:29:48.739162 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:29:48.748700 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:29:48.750918 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m22:29:48.756950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:29:48.763580 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:29:48.765254 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m22:29:48.770256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:29:48.799098 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:29:48.801102 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:29:48.803127 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:29:48.810693 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:29:48.818363 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:29:48.820223 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m22:29:48.829130 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:29:48.832426 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:29:48.609688 => 2024-02-25 22:29:48.832296
[0m22:29:48.833717 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:29:48.836012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff902f89bd0>]}
[0m22:29:48.837546 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.25s]
[0m22:29:48.840997 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:29:48.843360 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:29:48.844850 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:29:48.846869 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:29:48.847960 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:29:48.853274 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:29:48.875804 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:29:48.849474 => 2024-02-25 22:29:48.874552
[0m22:29:48.879895 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:29:48.891901 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:29:48.916072 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:29:48.919788 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:29:48.921374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:48.947362 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:29:48.948797 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:29:48.950470 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:29:48.961903 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:29:48.966229 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:29:48.968239 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m22:29:48.971949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:29:48.975840 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:29:48.977377 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m22:29:48.981431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:29:48.984770 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:29:48.985643 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:29:48.986735 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:29:48.992037 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:29:48.996409 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:29:48.997986 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m22:29:49.011766 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:29:49.017200 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:29:48.882460 => 2024-02-25 22:29:49.016994
[0m22:29:49.020314 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:29:49.022955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903167280>]}
[0m22:29:49.024940 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.18s]
[0m22:29:49.026682 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:29:49.028044 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:29:49.029360 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m22:29:49.032479 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:29:49.034148 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:29:49.041904 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:29:49.060558 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:29:49.035072 => 2024-02-25 22:29:49.060369
[0m22:29:49.062742 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:29:49.074268 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:29:49.099530 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:29:49.102295 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:29:49.104903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:49.137186 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:29:49.138230 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:29:49.139050 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:29:49.146981 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:29:49.155003 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:29:49.156983 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m22:29:49.162481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:29:49.169114 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:29:49.172575 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m22:29:49.179040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:29:49.185020 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:29:49.188564 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:29:49.191200 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:29:49.198748 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:29:49.202637 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:29:49.203838 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m22:29:49.211344 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:29:49.214509 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:29:49.063894 => 2024-02-25 22:29:49.214431
[0m22:29:49.215877 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:29:49.217588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903041d50>]}
[0m22:29:49.219153 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.19s]
[0m22:29:49.220307 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:29:49.223001 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:29:49.234570 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m22:29:49.236699 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m22:29:49.237885 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m22:29:49.244962 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m22:29:49.262660 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 22:29:49.238854 => 2024-02-25 22:29:49.262415
[0m22:29:49.263952 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m22:29:49.272499 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m22:29:49.295049 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:29:49.296335 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m22:29:49.299247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:49.337149 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:29:49.340195 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:29:49.341395 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            when user_rating >= 4.5 THEN 'EXCELLENT'
            when user_rating >= 4.0 THEN 'GOOD'
            when user_rating >= 3.0 THEN 'AVERAGE'
            else 'POOR'
        END as rating_category 
    FROM "destination_db"."public"."films"    
)


films_with_actors AS (
    SELECT 
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)


SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m22:29:49.344952 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "films_with_actors"
LINE 26: films_with_actors AS (
         ^

[0m22:29:49.346156 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m22:29:49.352763 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 22:29:49.265236 => 2024-02-25 22:29:49.350575
[0m22:29:49.358117 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m22:29:49.374857 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "films_with_actors"
  LINE 26: films_with_actors AS (
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:29:49.387827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe06ecd1-5fec-4e1c-afbc-36fa95df676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903112b00>]}
[0m22:29:49.393401 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.15s]
[0m22:29:49.396834 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:29:49.401619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:49.403121 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:49.404199 [debug] [MainThread]: On master: BEGIN
[0m22:29:49.405376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:29:49.429335 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:29:49.430920 [debug] [MainThread]: On master: COMMIT
[0m22:29:49.432765 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:49.434940 [debug] [MainThread]: On master: COMMIT
[0m22:29:49.439011 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:29:49.440431 [debug] [MainThread]: On master: Close
[0m22:29:49.442227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:49.443209 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m22:29:49.444352 [info ] [MainThread]: 
[0m22:29:49.445409 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m22:29:49.446840 [debug] [MainThread]: Command end result
[0m22:29:49.487769 [info ] [MainThread]: 
[0m22:29:49.492577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:29:49.494420 [info ] [MainThread]: 
[0m22:29:49.495639 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m22:29:49.496861 [error] [MainThread]:   syntax error at or near "films_with_actors"
[0m22:29:49.498240 [error] [MainThread]:   LINE 26: films_with_actors AS (
[0m22:29:49.500322 [error] [MainThread]:            ^
[0m22:29:49.502002 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:29:49.504669 [info ] [MainThread]: 
[0m22:29:49.510126 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:29:49.515705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903174880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903174bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903174cd0>]}
[0m22:29:49.517465 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 22:35:54.511165 | da3ed52c-8a88-4b9b-adae-d9e512dae752 ==============================
[0m22:35:54.511165 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:35:54.514909 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:35:54.516896 [debug] [MainThread]: Tracking: tracking
[0m22:35:54.520253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69178d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69178d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69178d3c0>]}
[0m22:35:54.547487 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:35:55.139710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:35:55.142048 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m22:35:55.176412 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m22:35:55.273908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68ff05330>]}
[0m22:35:55.328975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69176e650>]}
[0m22:35:55.332996 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:35:55.336375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb691799d20>]}
[0m22:35:55.342908 [info ] [MainThread]: 
[0m22:35:55.349481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:55.353571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:35:55.369231 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:35:55.372476 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:35:55.374100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:55.406356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:35:55.409843 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:35:55.414801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:35:55.424864 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:35:55.427032 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:35:55.429368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:55.457964 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:35:55.460825 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:35:55.463146 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:35:55.470364 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m22:35:55.473346 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:35:55.480105 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:35:55.493662 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:55.495315 [debug] [MainThread]: On master: BEGIN
[0m22:35:55.496885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:55.511643 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:35:55.513116 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:55.514440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:35:55.524441 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:35:55.527082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d54c7c0>]}
[0m22:35:55.528708 [debug] [MainThread]: On master: ROLLBACK
[0m22:35:55.532223 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:55.533852 [debug] [MainThread]: On master: BEGIN
[0m22:35:55.538295 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:35:55.539457 [debug] [MainThread]: On master: COMMIT
[0m22:35:55.540825 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:55.541935 [debug] [MainThread]: On master: COMMIT
[0m22:35:55.544968 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:35:55.546096 [debug] [MainThread]: On master: Close
[0m22:35:55.548887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:55.550134 [info ] [MainThread]: 
[0m22:35:55.568990 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:35:55.570601 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:35:55.572149 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:35:55.573253 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:35:55.577069 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:35:55.592126 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:35:55.574274 => 2024-02-25 22:35:55.591983
[0m22:35:55.593883 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:35:55.638432 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:35:55.671766 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:35:55.673859 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:35:55.675679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:55.694901 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:35:55.696545 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:35:55.697675 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:35:55.701292 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m22:35:55.702394 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m22:35:55.705074 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:35:55.595075 => 2024-02-25 22:35:55.704950
[0m22:35:55.706218 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:35:55.710943 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:35:55.712687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68fe7fca0>]}
[0m22:35:55.714554 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m22:35:55.717377 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:35:55.718986 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:35:55.721119 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:35:55.722769 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:35:55.723662 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:35:55.728545 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:35:55.740819 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:35:55.725044 => 2024-02-25 22:35:55.740642
[0m22:35:55.741939 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:35:55.747382 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:35:55.758563 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:35:55.759734 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:35:55.760679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:55.776414 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:35:55.777603 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:35:55.778486 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:35:55.781708 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m22:35:55.782835 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m22:35:55.785852 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:35:55.742619 => 2024-02-25 22:35:55.785710
[0m22:35:55.787038 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:35:55.789836 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:35:55.791919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68fec57e0>]}
[0m22:35:55.793167 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m22:35:55.794377 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:35:55.795665 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:35:55.797321 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m22:35:55.799517 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m22:35:55.800680 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m22:35:55.803591 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m22:35:55.816419 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 22:35:55.801747 => 2024-02-25 22:35:55.816247
[0m22:35:55.817583 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m22:35:55.824972 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m22:35:55.838307 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:35:55.840113 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m22:35:55.841226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:55.858662 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:35:55.859866 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:35:55.860874 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE WHEN user_rating > 4.5 THEN 'EXCELLENT' WHEN user_rating > 3.0 THEN 'GOOD' ELSE 'AVERAGE' END AS rating_category
  FROM
    films
)
SELECT
  f.film_id,
  f.title,
  STRINGS_AGG(a.actor_name, ',') AS actors
FROM
  films_with_ratings AS f
  JOIN film_actors AS fa ON f.film_id = fa.film_id
  JOIN actors AS a ON fa.actor_id = a.actor_id
GROUP BY
  f.film_id,
  f.title
ORDER BY
  f.film_id
  );
  
[0m22:35:55.863809 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" does not exist
LINE 18:     films
             ^

[0m22:35:55.865087 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m22:35:55.867846 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 22:35:55.818658 => 2024-02-25 22:35:55.867722
[0m22:35:55.868825 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m22:35:55.870850 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  relation "films" does not exist
  LINE 18:     films
               ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:35:55.873622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68fe7f940>]}
[0m22:35:55.875971 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.07s]
[0m22:35:55.877320 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:35:55.878616 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:35:55.880598 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m22:35:55.882109 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:35:55.883384 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:35:55.887931 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:35:55.896970 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:35:55.884381 => 2024-02-25 22:35:55.896322
[0m22:35:55.898439 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:35:55.904243 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:35:55.914168 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:35:55.915091 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:35:55.915968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:55.931740 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:35:55.932710 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:35:55.933583 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:35:55.935769 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m22:35:55.936557 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m22:35:55.938704 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:35:55.899262 => 2024-02-25 22:35:55.938622
[0m22:35:55.939562 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:35:55.941445 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:35:55.942402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3ed52c-8a88-4b9b-adae-d9e512dae752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68fe7d720>]}
[0m22:35:55.943441 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m22:35:55.944324 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:35:55.947130 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:55.947960 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:55.948562 [debug] [MainThread]: On master: BEGIN
[0m22:35:55.949239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:55.962190 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:35:55.963783 [debug] [MainThread]: On master: COMMIT
[0m22:35:55.964668 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:55.965581 [debug] [MainThread]: On master: COMMIT
[0m22:35:55.968382 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:35:55.969989 [debug] [MainThread]: On master: Close
[0m22:35:55.971340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:55.972229 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m22:35:55.973152 [info ] [MainThread]: 
[0m22:35:55.973964 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m22:35:55.974965 [debug] [MainThread]: Command end result
[0m22:35:55.993968 [info ] [MainThread]: 
[0m22:35:55.995241 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:35:55.996445 [info ] [MainThread]: 
[0m22:35:55.998205 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m22:35:56.001533 [error] [MainThread]:   relation "public.actors" does not exist
[0m22:35:56.002708 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m22:35:56.003726 [error] [MainThread]:                             ^
[0m22:35:56.004625 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:35:56.005631 [info ] [MainThread]: 
[0m22:35:56.006809 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m22:35:56.007757 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m22:35:56.008799 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m22:35:56.010047 [error] [MainThread]:                             ^
[0m22:35:56.011031 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:35:56.012039 [info ] [MainThread]: 
[0m22:35:56.013091 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m22:35:56.014174 [error] [MainThread]:   relation "films" does not exist
[0m22:35:56.015071 [error] [MainThread]:   LINE 18:     films
[0m22:35:56.016129 [error] [MainThread]:                ^
[0m22:35:56.017178 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:35:56.018059 [info ] [MainThread]: 
[0m22:35:56.019249 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m22:35:56.020282 [error] [MainThread]:   relation "public.films" does not exist
[0m22:35:56.021278 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m22:35:56.022271 [error] [MainThread]:                             ^
[0m22:35:56.023161 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:35:56.023978 [info ] [MainThread]: 
[0m22:35:56.024805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m22:35:56.025753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d5e9840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d5e8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d5e8c70>]}
[0m22:35:56.026635 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 22:41:09.387263 | 1dd8e51b-eeac-4737-b4d6-952ebebc9b21 ==============================
[0m22:41:09.387263 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:41:09.390676 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:41:09.392463 [debug] [MainThread]: Tracking: tracking
[0m22:41:09.395909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82c6d4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82c6d7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82c6d4b80>]}
[0m22:41:09.422264 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:41:10.096765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:10.099839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:10.111933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82ad93fa0>]}
[0m22:41:10.167058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82ad59f00>]}
[0m22:41:10.171110 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:41:10.174112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82ad59f30>]}
[0m22:41:10.180451 [info ] [MainThread]: 
[0m22:41:10.185832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:10.190563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:41:10.206308 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:41:10.209775 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:41:10.212803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:10.238143 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:41:10.241088 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:41:10.245620 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:41:10.252899 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:41:10.254440 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:41:10.256608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:10.275988 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:41:10.277510 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:41:10.278623 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:41:10.285045 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m22:41:10.288049 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:41:10.292638 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:41:10.304087 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:10.305759 [debug] [MainThread]: On master: BEGIN
[0m22:41:10.307460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:10.333513 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:41:10.335773 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:10.337695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:41:10.350925 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:41:10.354110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82add3850>]}
[0m22:41:10.355762 [debug] [MainThread]: On master: ROLLBACK
[0m22:41:10.360703 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:10.362723 [debug] [MainThread]: On master: BEGIN
[0m22:41:10.370773 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:41:10.373045 [debug] [MainThread]: On master: COMMIT
[0m22:41:10.375247 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:10.377183 [debug] [MainThread]: On master: COMMIT
[0m22:41:10.382334 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:41:10.384559 [debug] [MainThread]: On master: Close
[0m22:41:10.388236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:10.390581 [info ] [MainThread]: 
[0m22:41:10.398631 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:41:10.401254 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:41:10.403937 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:41:10.405951 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:41:10.412073 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:41:10.435512 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:41:10.408142 => 2024-02-25 22:41:10.435254
[0m22:41:10.438075 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:41:10.481483 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:41:10.515358 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:41:10.518431 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:41:10.521348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:10.554743 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:41:10.557043 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:41:10.559185 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:41:10.579440 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:41:10.593683 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:41:10.596553 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m22:41:10.604815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:41:10.610312 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:41:10.612173 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m22:41:10.618211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:41:10.643594 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:41:10.644891 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:41:10.646363 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:41:10.652780 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:41:10.659240 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:41:10.660324 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m22:41:10.665836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:41:10.668122 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:41:10.440477 => 2024-02-25 22:41:10.668047
[0m22:41:10.669034 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:41:10.670526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82abf8f70>]}
[0m22:41:10.672693 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.27s]
[0m22:41:10.675369 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:41:10.677037 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:41:10.678164 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:41:10.679569 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:41:10.680665 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:41:10.684243 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:41:10.692446 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:41:10.681431 => 2024-02-25 22:41:10.692368
[0m22:41:10.693327 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:41:10.698147 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:41:10.708962 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:41:10.709930 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:41:10.711460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:10.730165 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:41:10.731750 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:41:10.733251 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:41:10.743811 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:41:10.750095 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:41:10.751971 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m22:41:10.757669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:41:10.762972 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:41:10.764991 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m22:41:10.770703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:41:10.775743 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:41:10.778000 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:41:10.780082 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:41:10.788511 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:41:10.793573 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:41:10.795453 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m22:41:10.804622 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:41:10.808449 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:41:10.694053 => 2024-02-25 22:41:10.808370
[0m22:41:10.810539 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:41:10.813034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82abf97e0>]}
[0m22:41:10.815307 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.13s]
[0m22:41:10.817267 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:41:10.819625 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:41:10.821900 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m22:41:10.824392 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m22:41:10.826185 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m22:41:10.831240 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m22:41:10.857271 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 22:41:10.827881 => 2024-02-25 22:41:10.857062
[0m22:41:10.860732 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m22:41:10.872423 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m22:41:10.908693 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:41:10.911244 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m22:41:10.913826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:10.946492 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:41:10.949328 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:41:10.951240 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE WHEN user_rating > 4.5 THEN 'EXCELLENT' WHEN user_rating > 3.0 THEN 'GOOD' ELSE 'AVERAGE' END AS rating_category
  FROM
    films
)
SELECT
  f.film_id,
  f.title,
  STRINGS_AGG(a.actor_name, ',') AS actors
FROM
  films_with_ratings AS f
  JOIN film_actors AS fa ON f.film_id = fa.film_id
  JOIN actors AS a ON fa.actor_id = a.actor_id
GROUP BY
  f.film_id,
  f.title
ORDER BY
  f.film_id
  );
  
[0m22:41:10.958034 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function strings_agg(character varying, unknown) does not exist
LINE 23:   STRINGS_AGG(a.actor_name, ',') AS actors
           ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m22:41:10.960721 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m22:41:10.965424 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 22:41:10.864276 => 2024-02-25 22:41:10.965294
[0m22:41:10.967133 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m22:41:10.971367 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  function strings_agg(character varying, unknown) does not exist
  LINE 23:   STRINGS_AGG(a.actor_name, ',') AS actors
             ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:41:10.973314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82acb5ae0>]}
[0m22:41:10.975117 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.15s]
[0m22:41:10.976521 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:41:10.977974 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:41:10.979109 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m22:41:10.981044 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:41:10.982148 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:41:10.987432 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:41:11.009049 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:41:10.983575 => 2024-02-25 22:41:11.008861
[0m22:41:11.012304 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:41:11.022366 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:41:11.057784 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:41:11.060580 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:41:11.063146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:11.085725 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:41:11.087069 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:41:11.088846 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:41:11.102283 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:41:11.108084 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:41:11.109289 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m22:41:11.112589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:41:11.116334 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:41:11.117818 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m22:41:11.122343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:41:11.126350 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:41:11.128597 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:41:11.131057 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:41:11.139225 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:41:11.143658 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:41:11.145725 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m22:41:11.154804 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:41:11.158048 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:41:11.015207 => 2024-02-25 22:41:11.157983
[0m22:41:11.159852 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:41:11.162342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd8e51b-eeac-4737-b4d6-952ebebc9b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82ac76110>]}
[0m22:41:11.165038 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.18s]
[0m22:41:11.166987 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:41:11.170414 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:11.172097 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:11.173846 [debug] [MainThread]: On master: BEGIN
[0m22:41:11.175480 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:11.202518 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:41:11.204459 [debug] [MainThread]: On master: COMMIT
[0m22:41:11.206401 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:11.208758 [debug] [MainThread]: On master: COMMIT
[0m22:41:11.214668 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:41:11.217172 [debug] [MainThread]: On master: Close
[0m22:41:11.220059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:11.222653 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m22:41:11.225240 [info ] [MainThread]: 
[0m22:41:11.227747 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m22:41:11.230334 [debug] [MainThread]: Command end result
[0m22:41:11.279577 [info ] [MainThread]: 
[0m22:41:11.282839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:41:11.285129 [info ] [MainThread]: 
[0m22:41:11.287438 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m22:41:11.289660 [error] [MainThread]:   function strings_agg(character varying, unknown) does not exist
[0m22:41:11.291654 [error] [MainThread]:   LINE 23:   STRINGS_AGG(a.actor_name, ',') AS actors
[0m22:41:11.293717 [error] [MainThread]:              ^
[0m22:41:11.295532 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m22:41:11.297951 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:41:11.299876 [info ] [MainThread]: 
[0m22:41:11.301840 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:41:11.303766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82accfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82ad59b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82ac3b4c0>]}
[0m22:41:11.305306 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 22:43:00.922123 | ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea ==============================
[0m22:43:00.922123 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:43:00.925365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:43:00.927084 [debug] [MainThread]: Tracking: tracking
[0m22:43:00.930094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f070690f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f070697b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f07069390>]}
[0m22:43:00.955189 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:43:01.332703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:01.334940 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m22:43:01.366654 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m22:43:01.467924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f057e8f40>]}
[0m22:43:01.520932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f0703a4d0>]}
[0m22:43:01.525671 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:43:01.529636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f07081d20>]}
[0m22:43:01.538452 [info ] [MainThread]: 
[0m22:43:01.548669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:01.555911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:43:01.580001 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:43:01.582290 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:43:01.584409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:01.619004 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:43:01.623580 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:43:01.627124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:43:01.635236 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:43:01.636922 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:43:01.639522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:01.662162 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:43:01.664053 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:43:01.665592 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:43:01.672464 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m22:43:01.675853 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:43:01.680469 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:43:01.687882 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:01.690143 [debug] [MainThread]: On master: BEGIN
[0m22:43:01.691599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:01.721282 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:43:01.724944 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:01.727505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:01.739541 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:43:01.743198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efed4c7c0>]}
[0m22:43:01.745569 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:01.750878 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:01.752718 [debug] [MainThread]: On master: BEGIN
[0m22:43:01.761001 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:43:01.763012 [debug] [MainThread]: On master: COMMIT
[0m22:43:01.764148 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:01.765797 [debug] [MainThread]: On master: COMMIT
[0m22:43:01.771400 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:43:01.773531 [debug] [MainThread]: On master: Close
[0m22:43:01.776170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:01.778230 [info ] [MainThread]: 
[0m22:43:01.794586 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:43:01.797089 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:43:01.799523 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:43:01.801643 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:43:01.806745 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:43:01.827542 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:43:01.803775 => 2024-02-25 22:43:01.827397
[0m22:43:01.829403 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:43:01.874721 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:43:01.892591 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:43:01.894253 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:43:01.895572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:01.914829 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:43:01.916759 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:43:01.918018 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:43:01.922179 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m22:43:01.923564 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m22:43:01.929263 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:43:01.831365 => 2024-02-25 22:43:01.929158
[0m22:43:01.930775 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:43:01.934865 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:43:01.936563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f05765d80>]}
[0m22:43:01.938538 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m22:43:01.941591 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:43:01.942832 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:43:01.943641 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:43:01.944829 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:43:01.945633 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:43:01.948936 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:43:01.960419 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:43:01.946354 => 2024-02-25 22:43:01.960243
[0m22:43:01.961700 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:43:01.966486 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:43:01.978599 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:43:01.979673 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:43:01.981266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:01.997415 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:43:01.999019 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:43:02.000366 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:43:02.003406 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m22:43:02.004432 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m22:43:02.007576 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:43:01.962479 => 2024-02-25 22:43:02.007491
[0m22:43:02.008507 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:43:02.010035 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:43:02.010830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f07081d20>]}
[0m22:43:02.012180 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m22:43:02.013233 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:43:02.014355 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:43:02.015301 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m22:43:02.017016 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m22:43:02.017896 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m22:43:02.020423 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m22:43:02.030376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 22:43:02.018819 => 2024-02-25 22:43:02.030229
[0m22:43:02.031407 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m22:43:02.036097 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m22:43:02.051030 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:43:02.052081 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m22:43:02.053346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:02.070416 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:43:02.071865 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:43:02.073367 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE WHEN user_rating > 4.5 THEN 'EXCELLENT' WHEN user_rating > 3.0 THEN 'GOOD' ELSE 'AVERAGE' END AS rating_category
  FROM
    films
)
SELECT
  f.film_id,
  f.title,
  STRING_AGG(a.actor_name, ',') AS actors
FROM
  films_with_ratings AS f
  JOIN film_actors AS fa ON f.film_id = fa.film_id
  JOIN actors AS a ON fa.actor_id = a.actor_id
GROUP BY
  f.film_id,
  f.title
ORDER BY
  f.film_id
  );
  
[0m22:43:02.078062 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" does not exist
LINE 18:     films
             ^

[0m22:43:02.080016 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m22:43:02.083316 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 22:43:02.032142 => 2024-02-25 22:43:02.083205
[0m22:43:02.084670 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m22:43:02.086826 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  relation "films" does not exist
  LINE 18:     films
               ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:43:02.087863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f05765750>]}
[0m22:43:02.089382 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.07s]
[0m22:43:02.090469 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:43:02.091721 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:43:02.093041 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m22:43:02.094907 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:43:02.096961 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:43:02.102096 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:43:02.117649 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:43:02.098480 => 2024-02-25 22:43:02.117491
[0m22:43:02.119205 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:43:02.125599 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:43:02.138049 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:43:02.139080 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:43:02.140214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:02.156820 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:43:02.158554 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:43:02.159469 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:43:02.162266 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m22:43:02.163276 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m22:43:02.165899 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:43:02.120535 => 2024-02-25 22:43:02.165771
[0m22:43:02.167179 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:43:02.169153 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:43:02.170653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee67f2a5-0d16-4e48-86a4-9f0c1aedd3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f05765450>]}
[0m22:43:02.171929 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m22:43:02.173299 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:43:02.176059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:02.177149 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:02.178510 [debug] [MainThread]: On master: BEGIN
[0m22:43:02.179755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:02.197713 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:43:02.200174 [debug] [MainThread]: On master: COMMIT
[0m22:43:02.201415 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:02.202660 [debug] [MainThread]: On master: COMMIT
[0m22:43:02.205960 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:43:02.207282 [debug] [MainThread]: On master: Close
[0m22:43:02.208857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:02.209870 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m22:43:02.211026 [info ] [MainThread]: 
[0m22:43:02.212758 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m22:43:02.214515 [debug] [MainThread]: Command end result
[0m22:43:02.237193 [info ] [MainThread]: 
[0m22:43:02.238556 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:43:02.239717 [info ] [MainThread]: 
[0m22:43:02.241053 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m22:43:02.242343 [error] [MainThread]:   relation "public.actors" does not exist
[0m22:43:02.244140 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m22:43:02.245397 [error] [MainThread]:                             ^
[0m22:43:02.249034 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m22:43:02.250396 [info ] [MainThread]: 
[0m22:43:02.251583 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m22:43:02.252827 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m22:43:02.253892 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m22:43:02.255183 [error] [MainThread]:                             ^
[0m22:43:02.256236 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m22:43:02.257235 [info ] [MainThread]: 
[0m22:43:02.258328 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m22:43:02.259671 [error] [MainThread]:   relation "films" does not exist
[0m22:43:02.261908 [error] [MainThread]:   LINE 18:     films
[0m22:43:02.264719 [error] [MainThread]:                ^
[0m22:43:02.266671 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m22:43:02.268217 [info ] [MainThread]: 
[0m22:43:02.269572 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m22:43:02.270804 [error] [MainThread]:   relation "public.films" does not exist
[0m22:43:02.272116 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m22:43:02.273091 [error] [MainThread]:                             ^
[0m22:43:02.274332 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m22:43:02.275392 [info ] [MainThread]: 
[0m22:43:02.276274 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m22:43:02.277756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efedf1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efedf13f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efedf3340>]}
[0m22:43:02.279630 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 22:48:19.187295 | 38624bcb-2c5f-40cc-952e-f3d902d0d3b6 ==============================
[0m22:48:19.187295 [info ] [MainThread]: Running with dbt=1.4.7
[0m22:48:19.190588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:48:19.192307 [debug] [MainThread]: Tracking: tracking
[0m22:48:19.195282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e8dbcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e8dbf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e8dbcb80>]}
[0m22:48:19.221586 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m22:48:19.598416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:48:19.599938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:48:19.607778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e746ffa0>]}
[0m22:48:19.641588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e7435f00>]}
[0m22:48:19.643345 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:48:19.644851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e7435f30>]}
[0m22:48:19.647773 [info ] [MainThread]: 
[0m22:48:19.651116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:48:19.653750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m22:48:19.667161 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m22:48:19.668604 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m22:48:19.670344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:19.716428 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m22:48:19.718976 [debug] [ThreadPool]: On list_destination_db: Close
[0m22:48:19.723069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m22:48:19.730437 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:48:19.731429 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m22:48:19.732577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:19.748844 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:48:19.749829 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m22:48:19.751047 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:48:19.762287 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m22:48:19.766122 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m22:48:19.771452 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m22:48:19.782215 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:19.784435 [debug] [MainThread]: On master: BEGIN
[0m22:48:19.786180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:19.801902 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:48:19.803155 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:19.804325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:48:19.817284 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:48:19.819872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e72b7850>]}
[0m22:48:19.821484 [debug] [MainThread]: On master: ROLLBACK
[0m22:48:19.825961 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:19.827866 [debug] [MainThread]: On master: BEGIN
[0m22:48:19.833127 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:48:19.834217 [debug] [MainThread]: On master: COMMIT
[0m22:48:19.835108 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:19.836017 [debug] [MainThread]: On master: COMMIT
[0m22:48:19.838415 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:48:19.839472 [debug] [MainThread]: On master: Close
[0m22:48:19.841693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:19.843403 [info ] [MainThread]: 
[0m22:48:19.848713 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m22:48:19.849871 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m22:48:19.851188 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m22:48:19.852064 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m22:48:19.855650 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m22:48:19.866724 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 22:48:19.852973 => 2024-02-25 22:48:19.866583
[0m22:48:19.868293 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m22:48:19.914900 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m22:48:19.941909 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:48:19.943727 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m22:48:19.945924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:19.964707 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:48:19.966524 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:48:19.967708 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m22:48:19.992659 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:48:20.003363 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:48:20.004672 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m22:48:20.010160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:48:20.016272 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:48:20.017436 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m22:48:20.021753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:48:20.046196 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:48:20.049331 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:48:20.052238 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m22:48:20.062080 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:48:20.068236 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m22:48:20.069896 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m22:48:20.080705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:48:20.083004 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 22:48:19.869584 => 2024-02-25 22:48:20.082916
[0m22:48:20.083950 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m22:48:20.085687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e72d8f70>]}
[0m22:48:20.087493 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.23s]
[0m22:48:20.090176 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m22:48:20.091310 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m22:48:20.092616 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m22:48:20.093800 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m22:48:20.095145 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m22:48:20.099214 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m22:48:20.109918 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 22:48:20.096349 => 2024-02-25 22:48:20.109496
[0m22:48:20.111854 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m22:48:20.117461 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m22:48:20.132390 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:48:20.133322 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m22:48:20.134069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:20.148545 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:48:20.149762 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:48:20.150388 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m22:48:20.161037 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:48:20.165363 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:48:20.166398 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m22:48:20.170681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:48:20.176592 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:48:20.178374 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m22:48:20.184601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:48:20.189863 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:48:20.191466 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:48:20.192333 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m22:48:20.197542 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:48:20.200813 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m22:48:20.202241 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m22:48:20.212039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:48:20.215004 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 22:48:20.113152 => 2024-02-25 22:48:20.214933
[0m22:48:20.216264 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m22:48:20.218179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e72d97e0>]}
[0m22:48:20.220026 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.12s]
[0m22:48:20.221811 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m22:48:20.223920 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m22:48:20.225700 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m22:48:20.227222 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m22:48:20.228306 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m22:48:20.231982 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m22:48:20.245291 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 22:48:20.229110 => 2024-02-25 22:48:20.245111
[0m22:48:20.247571 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m22:48:20.253521 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m22:48:20.265788 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:48:20.266888 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m22:48:20.267922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:20.286546 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:48:20.288029 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:48:20.288964 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE WHEN user_rating > 4.5 THEN 'EXCELLENT' WHEN user_rating > 3.0 THEN 'GOOD' ELSE 'AVERAGE' END AS rating_category
  FROM
    films
)
SELECT
  f.film_id,
  f.title,
  STRING_AGG(a.actor_name, ',') AS actors
FROM
  films_with_ratings AS f
  JOIN film_actors AS fa ON f.film_id = fa.film_id
  JOIN actors AS a ON fa.actor_id = a.actor_id
GROUP BY
  f.film_id,
  f.title
ORDER BY
  f.film_id
  );
  
[0m22:48:20.312591 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:48:20.316993 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:48:20.318487 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m22:48:20.323530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:48:20.328379 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m22:48:20.329936 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:48:20.331592 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m22:48:20.338550 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:48:20.342565 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m22:48:20.343611 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m22:48:20.347303 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:48:20.349473 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 22:48:20.248550 => 2024-02-25 22:48:20.349419
[0m22:48:20.350886 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m22:48:20.353471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e73963e0>]}
[0m22:48:20.355076 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.13s]
[0m22:48:20.356499 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m22:48:20.358184 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m22:48:20.359638 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m22:48:20.361425 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m22:48:20.363105 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m22:48:20.368977 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m22:48:20.383913 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 22:48:20.364597 => 2024-02-25 22:48:20.383767
[0m22:48:20.385450 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m22:48:20.392714 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m22:48:20.413393 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:48:20.414899 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m22:48:20.416407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:20.433741 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:48:20.435065 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:48:20.436294 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m22:48:20.444709 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m22:48:20.449758 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:48:20.451276 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m22:48:20.455868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:48:20.460875 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:48:20.462472 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m22:48:20.466594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:48:20.470377 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:48:20.471713 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:48:20.472915 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m22:48:20.480882 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:48:20.485681 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m22:48:20.487314 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m22:48:20.495697 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:48:20.499617 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 22:48:20.387135 => 2024-02-25 22:48:20.499552
[0m22:48:20.501416 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m22:48:20.504206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38624bcb-2c5f-40cc-952e-f3d902d0d3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e738ba60>]}
[0m22:48:20.506474 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.14s]
[0m22:48:20.508171 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m22:48:20.511145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:48:20.512391 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:20.513976 [debug] [MainThread]: On master: BEGIN
[0m22:48:20.514984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:20.531931 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:48:20.532969 [debug] [MainThread]: On master: COMMIT
[0m22:48:20.533863 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:20.534504 [debug] [MainThread]: On master: COMMIT
[0m22:48:20.537009 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:48:20.538459 [debug] [MainThread]: On master: Close
[0m22:48:20.540068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:20.541266 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m22:48:20.542198 [info ] [MainThread]: 
[0m22:48:20.543167 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m22:48:20.544182 [debug] [MainThread]: Command end result
[0m22:48:20.565727 [info ] [MainThread]: 
[0m22:48:20.567100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:48:20.568493 [info ] [MainThread]: 
[0m22:48:20.569716 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:48:20.570905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e51938e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e51912a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e51922c0>]}
[0m22:48:20.572112 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 23:27:32.600253 | 3911ff54-74f8-4482-8a0a-6724ba9916e9 ==============================
[0m23:27:32.600253 [info ] [MainThread]: Running with dbt=1.4.7
[0m23:27:32.605859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:27:32.607912 [debug] [MainThread]: Tracking: tracking
[0m23:27:32.611985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e7649360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e76497e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e76493c0>]}
[0m23:27:32.640080 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m23:27:33.333903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:27:33.338266 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m23:27:33.373425 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m23:27:33.466161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3911ff54-74f8-4482-8a0a-6724ba9916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5db5960>]}
[0m23:27:33.505621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3911ff54-74f8-4482-8a0a-6724ba9916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e762a800>]}
[0m23:27:33.508399 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:27:33.511795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3911ff54-74f8-4482-8a0a-6724ba9916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e764fc10>]}
[0m23:27:33.517091 [info ] [MainThread]: 
[0m23:27:33.521473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:33.525237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:27:33.545263 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:27:33.547989 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:27:33.550411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:33.580510 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m23:27:33.584259 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:27:33.587493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m23:27:33.595940 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:27:33.597646 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:27:33.599140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:33.620454 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:27:33.622207 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:27:33.623966 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:27:33.629874 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m23:27:33.632577 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:27:33.637054 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:27:33.645532 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:33.646941 [debug] [MainThread]: On master: BEGIN
[0m23:27:33.647908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:33.669664 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:27:33.672281 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:33.673682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:27:33.682554 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:27:33.685503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3911ff54-74f8-4482-8a0a-6724ba9916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13cf323310>]}
[0m23:27:33.687908 [debug] [MainThread]: On master: ROLLBACK
[0m23:27:33.692359 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:33.693733 [debug] [MainThread]: On master: BEGIN
[0m23:27:33.698329 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:27:33.699626 [debug] [MainThread]: On master: COMMIT
[0m23:27:33.700811 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:33.701862 [debug] [MainThread]: On master: COMMIT
[0m23:27:33.708402 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:27:33.711508 [debug] [MainThread]: On master: Close
[0m23:27:33.713660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:33.714937 [info ] [MainThread]: 
[0m23:27:33.743198 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:27:33.745636 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:27:33.748011 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m23:27:33.749114 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:27:33.753714 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:27:33.779271 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 23:27:33.750035 => 2024-02-25 23:27:33.779113
[0m23:27:33.781491 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:27:33.832285 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:27:33.865839 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:33.868719 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:27:33.871952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:33.907224 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:27:33.909227 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:33.911415 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:27:33.917352 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m23:27:33.919443 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m23:27:33.923647 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 23:27:33.782943 => 2024-02-25 23:27:33.923511
[0m23:27:33.924937 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:27:33.930143 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:27:33.932444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3911ff54-74f8-4482-8a0a-6724ba9916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5d895d0>]}
[0m23:27:33.933664 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.18s]
[0m23:27:33.936497 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:27:33.938976 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:27:33.942213 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:27:33.945406 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m23:27:33.946723 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:27:33.951014 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:27:33.970454 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 23:27:33.947915 => 2024-02-25 23:27:33.970287
[0m23:27:33.973187 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:27:33.979055 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:27:33.998908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:34.000326 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:27:34.001275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:34.025108 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:27:34.026410 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:34.027312 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:27:34.030139 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m23:27:34.031541 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m23:27:34.037052 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 23:27:33.974906 => 2024-02-25 23:27:34.036906
[0m23:27:34.038348 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:27:34.040595 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:27:34.041773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3911ff54-74f8-4482-8a0a-6724ba9916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5d7af80>]}
[0m23:27:34.043403 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.10s]
[0m23:27:34.044767 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:27:34.045908 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:27:34.047229 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:27:34.049466 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m23:27:34.050603 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:27:34.056100 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:27:34.071244 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 23:27:34.051664 => 2024-02-25 23:27:34.070865
[0m23:27:34.074188 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:27:34.082385 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:27:34.101691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:34.103203 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:27:34.105087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:34.123497 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:27:34.124687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:34.125622 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:27:34.127939 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m23:27:34.128926 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m23:27:34.132043 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 23:27:34.077244 => 2024-02-25 23:27:34.131648
[0m23:27:34.133040 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:27:34.134890 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:27:34.135963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3911ff54-74f8-4482-8a0a-6724ba9916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5d8b0a0>]}
[0m23:27:34.138272 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m23:27:34.140815 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:27:34.143736 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:27:34.144736 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m23:27:34.145762 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:27:34.149032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:34.149997 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:34.151043 [debug] [MainThread]: On master: BEGIN
[0m23:27:34.151876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:34.169487 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:27:34.170963 [debug] [MainThread]: On master: COMMIT
[0m23:27:34.172720 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:34.174557 [debug] [MainThread]: On master: COMMIT
[0m23:27:34.178444 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:27:34.179514 [debug] [MainThread]: On master: Close
[0m23:27:34.181791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:34.182938 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m23:27:34.183902 [info ] [MainThread]: 
[0m23:27:34.184873 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m23:27:34.186240 [debug] [MainThread]: Command end result
[0m23:27:34.226110 [info ] [MainThread]: 
[0m23:27:34.231585 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m23:27:34.233827 [info ] [MainThread]: 
[0m23:27:34.235576 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m23:27:34.237740 [error] [MainThread]:   relation "public.actors" does not exist
[0m23:27:34.240627 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m23:27:34.241822 [error] [MainThread]:                             ^
[0m23:27:34.243138 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:27:34.244676 [info ] [MainThread]: 
[0m23:27:34.246040 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m23:27:34.247445 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m23:27:34.248937 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m23:27:34.250114 [error] [MainThread]:                             ^
[0m23:27:34.251637 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:27:34.252814 [info ] [MainThread]: 
[0m23:27:34.253909 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m23:27:34.255130 [error] [MainThread]:   relation "public.films" does not exist
[0m23:27:34.256146 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m23:27:34.257154 [error] [MainThread]:                             ^
[0m23:27:34.258281 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:27:34.259354 [info ] [MainThread]: 
[0m23:27:34.260508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m23:27:34.261622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13cf323310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e762ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e762ae60>]}
[0m23:27:34.263807 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 23:28:54.538248 | d0abc137-009e-49d6-982e-aa90b7dbacc7 ==============================
[0m23:28:54.538248 [info ] [MainThread]: Running with dbt=1.4.7
[0m23:28:54.541292 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:28:54.542905 [debug] [MainThread]: Tracking: tracking
[0m23:28:54.546046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a3610f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a3617b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a361390>]}
[0m23:28:54.577225 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m23:28:55.084838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:28:55.087298 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m23:28:55.116783 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m23:28:55.209316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0abc137-009e-49d6-982e-aa90b7dbacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458add810>]}
[0m23:28:55.244790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0abc137-009e-49d6-982e-aa90b7dbacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a3426b0>]}
[0m23:28:55.246551 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:28:55.248271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0abc137-009e-49d6-982e-aa90b7dbacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a36c1f0>]}
[0m23:28:55.251195 [info ] [MainThread]: 
[0m23:28:55.254155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:28:55.256898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:28:55.271148 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:28:55.273116 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:28:55.274622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:55.298763 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m23:28:55.302901 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:28:55.307087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m23:28:55.314295 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:28:55.315586 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:28:55.316952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:55.334240 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:28:55.336652 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:28:55.338397 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:28:55.342912 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m23:28:55.344932 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:28:55.348397 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:28:55.357506 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:55.358842 [debug] [MainThread]: On master: BEGIN
[0m23:28:55.360666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:28:55.380494 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:28:55.382057 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:55.383733 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:28:55.395247 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:28:55.398408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0abc137-009e-49d6-982e-aa90b7dbacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe456318730>]}
[0m23:28:55.400778 [debug] [MainThread]: On master: ROLLBACK
[0m23:28:55.404051 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:55.405203 [debug] [MainThread]: On master: BEGIN
[0m23:28:55.409939 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:28:55.411172 [debug] [MainThread]: On master: COMMIT
[0m23:28:55.412131 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:55.413283 [debug] [MainThread]: On master: COMMIT
[0m23:28:55.416941 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:28:55.418823 [debug] [MainThread]: On master: Close
[0m23:28:55.421918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:55.423264 [info ] [MainThread]: 
[0m23:28:55.440112 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:28:55.443989 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:28:55.446590 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m23:28:55.448237 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:28:55.454562 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:28:55.467222 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 23:28:55.449242 => 2024-02-25 23:28:55.466664
[0m23:28:55.471023 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:28:55.520003 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:28:55.532304 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:28:55.533724 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:28:55.534904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:55.547587 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:28:55.548693 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:28:55.549689 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:28:55.552500 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m23:28:55.553448 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m23:28:55.555872 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 23:28:55.473362 => 2024-02-25 23:28:55.555781
[0m23:28:55.557018 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:28:55.559426 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:28:55.560569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0abc137-009e-49d6-982e-aa90b7dbacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458abe650>]}
[0m23:28:55.561728 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m23:28:55.564262 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:28:55.565239 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:28:55.566376 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:28:55.567724 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m23:28:55.568742 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:28:55.574176 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:28:55.594491 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 23:28:55.569507 => 2024-02-25 23:28:55.594007
[0m23:28:55.595830 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:28:55.601033 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:28:55.617857 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:28:55.619312 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:28:55.620707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:55.641584 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:28:55.642903 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:28:55.643992 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:28:55.646985 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m23:28:55.648180 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m23:28:55.651005 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 23:28:55.596823 => 2024-02-25 23:28:55.650919
[0m23:28:55.652290 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:28:55.654701 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:28:55.657136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0abc137-009e-49d6-982e-aa90b7dbacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458a98b50>]}
[0m23:28:55.658894 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m23:28:55.660414 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:28:55.661315 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:28:55.662252 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:28:55.664008 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m23:28:55.664989 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:28:55.668837 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:28:55.679527 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 23:28:55.666019 => 2024-02-25 23:28:55.679383
[0m23:28:55.680441 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:28:55.685418 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:28:55.695705 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:28:55.696775 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:28:55.697652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:55.715777 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:28:55.717672 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:28:55.719792 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:28:55.723457 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m23:28:55.724520 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m23:28:55.727742 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 23:28:55.681253 => 2024-02-25 23:28:55.727660
[0m23:28:55.728990 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:28:55.730814 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:28:55.731823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0abc137-009e-49d6-982e-aa90b7dbacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458abdfc0>]}
[0m23:28:55.733079 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m23:28:55.734040 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:28:55.735958 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:28:55.736972 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m23:28:55.738393 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:28:55.741629 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:28:55.743042 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:55.743889 [debug] [MainThread]: On master: BEGIN
[0m23:28:55.744699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:28:55.760558 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:28:55.761881 [debug] [MainThread]: On master: COMMIT
[0m23:28:55.762809 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:55.763627 [debug] [MainThread]: On master: COMMIT
[0m23:28:55.766417 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:28:55.767298 [debug] [MainThread]: On master: Close
[0m23:28:55.768561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:55.769466 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m23:28:55.771179 [info ] [MainThread]: 
[0m23:28:55.772839 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m23:28:55.774186 [debug] [MainThread]: Command end result
[0m23:28:55.796171 [info ] [MainThread]: 
[0m23:28:55.797567 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m23:28:55.798709 [info ] [MainThread]: 
[0m23:28:55.799851 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m23:28:55.800835 [error] [MainThread]:   relation "public.actors" does not exist
[0m23:28:55.801965 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m23:28:55.802903 [error] [MainThread]:                             ^
[0m23:28:55.803961 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:28:55.806053 [info ] [MainThread]: 
[0m23:28:55.807926 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m23:28:55.809080 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m23:28:55.810692 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m23:28:55.812131 [error] [MainThread]:                             ^
[0m23:28:55.813542 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:28:55.814946 [info ] [MainThread]: 
[0m23:28:55.816225 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m23:28:55.817360 [error] [MainThread]:   relation "public.films" does not exist
[0m23:28:55.818449 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m23:28:55.819279 [error] [MainThread]:                             ^
[0m23:28:55.820387 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:28:55.821867 [info ] [MainThread]: 
[0m23:28:55.823324 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m23:28:55.824672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458abf2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458abd840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe456318730>]}
[0m23:28:55.825963 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 23:32:23.188564 | 8973d0af-1f55-4352-9ee2-825b7dd73503 ==============================
[0m23:32:23.188564 [info ] [MainThread]: Running with dbt=1.4.7
[0m23:32:23.192331 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:32:23.193906 [debug] [MainThread]: Tracking: tracking
[0m23:32:23.197155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd74fc9360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd74fc97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd74fc93c0>]}
[0m23:32:23.222331 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m23:32:23.717250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:23.720516 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m23:32:23.747861 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m23:32:23.840578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8973d0af-1f55-4352-9ee2-825b7dd73503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70d3c4c0>]}
[0m23:32:23.878276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8973d0af-1f55-4352-9ee2-825b7dd73503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd74f9a6b0>]}
[0m23:32:23.879884 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:32:23.881638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8973d0af-1f55-4352-9ee2-825b7dd73503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd74fe0880>]}
[0m23:32:23.885506 [info ] [MainThread]: 
[0m23:32:23.889245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:23.892135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:32:23.906598 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:32:23.909020 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:32:23.910652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:23.938046 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m23:32:23.941521 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:32:23.945407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m23:32:23.953517 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:32:23.955831 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:32:23.958226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:23.981652 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:32:23.984384 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:32:23.985847 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:32:23.996625 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m23:32:23.999975 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:32:24.008124 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:32:24.016895 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:24.019117 [debug] [MainThread]: On master: BEGIN
[0m23:32:24.021025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:24.055013 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:24.056856 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:24.058810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:24.068283 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:32:24.071767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8973d0af-1f55-4352-9ee2-825b7dd73503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70d88730>]}
[0m23:32:24.074183 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:24.079693 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:24.081279 [debug] [MainThread]: On master: BEGIN
[0m23:32:24.090329 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:24.092160 [debug] [MainThread]: On master: COMMIT
[0m23:32:24.093694 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:24.094905 [debug] [MainThread]: On master: COMMIT
[0m23:32:24.099056 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:32:24.101168 [debug] [MainThread]: On master: Close
[0m23:32:24.104058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:24.105740 [info ] [MainThread]: 
[0m23:32:24.125707 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:32:24.127433 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:32:24.129554 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m23:32:24.132204 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:32:24.136985 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:32:24.153019 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 23:32:24.133729 => 2024-02-25 23:32:24.152843
[0m23:32:24.154738 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:32:24.200472 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:32:24.226818 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:24.229495 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:32:24.232088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:24.252761 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:32:24.254735 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:24.256534 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:32:24.261164 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m23:32:24.262797 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m23:32:24.266254 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 23:32:24.155747 => 2024-02-25 23:32:24.266142
[0m23:32:24.267399 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:32:24.270156 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:32:24.271774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973d0af-1f55-4352-9ee2-825b7dd73503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70d3d4e0>]}
[0m23:32:24.272869 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m23:32:24.275321 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:32:24.276268 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:32:24.277155 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:32:24.278408 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m23:32:24.279155 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:32:24.282724 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:32:24.293360 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 23:32:24.279804 => 2024-02-25 23:32:24.293235
[0m23:32:24.294268 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:32:24.299109 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:32:24.309348 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:24.310191 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:32:24.310856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:24.325827 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:32:24.327142 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:24.328359 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:32:24.331533 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m23:32:24.332406 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m23:32:24.336455 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 23:32:24.294943 => 2024-02-25 23:32:24.336093
[0m23:32:24.338052 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:32:24.340152 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:32:24.341350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973d0af-1f55-4352-9ee2-825b7dd73503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd73713af0>]}
[0m23:32:24.342515 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m23:32:24.343553 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:32:24.344819 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:32:24.346084 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:32:24.347556 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m23:32:24.348462 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:32:24.353007 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:32:24.360964 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 23:32:24.349451 => 2024-02-25 23:32:24.360870
[0m23:32:24.362014 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:32:24.367186 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:32:24.376250 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:32:24.377092 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:32:24.378006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:24.393018 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:32:24.394074 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:32:24.394997 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:32:24.397354 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m23:32:24.398233 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m23:32:24.401242 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 23:32:24.362795 => 2024-02-25 23:32:24.400990
[0m23:32:24.402587 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:32:24.404687 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:32:24.405675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973d0af-1f55-4352-9ee2-825b7dd73503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70d3e2f0>]}
[0m23:32:24.406850 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m23:32:24.407910 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:32:24.409612 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:32:24.410535 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m23:32:24.411551 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:32:24.413596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:24.414469 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:24.415520 [debug] [MainThread]: On master: BEGIN
[0m23:32:24.416598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:24.430290 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:24.431524 [debug] [MainThread]: On master: COMMIT
[0m23:32:24.432511 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:24.433717 [debug] [MainThread]: On master: COMMIT
[0m23:32:24.436903 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:32:24.437874 [debug] [MainThread]: On master: Close
[0m23:32:24.439236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:24.440344 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m23:32:24.441464 [info ] [MainThread]: 
[0m23:32:24.442618 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m23:32:24.443844 [debug] [MainThread]: Command end result
[0m23:32:24.468828 [info ] [MainThread]: 
[0m23:32:24.470765 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m23:32:24.472132 [info ] [MainThread]: 
[0m23:32:24.473633 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m23:32:24.474847 [error] [MainThread]:   relation "public.actors" does not exist
[0m23:32:24.476029 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m23:32:24.477011 [error] [MainThread]:                             ^
[0m23:32:24.477821 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:32:24.478622 [info ] [MainThread]: 
[0m23:32:24.479789 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m23:32:24.480765 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m23:32:24.481949 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m23:32:24.483097 [error] [MainThread]:                             ^
[0m23:32:24.484536 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:32:24.485797 [info ] [MainThread]: 
[0m23:32:24.487260 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m23:32:24.488529 [error] [MainThread]:   relation "public.films" does not exist
[0m23:32:24.489505 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m23:32:24.490534 [error] [MainThread]:                             ^
[0m23:32:24.491415 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:32:24.492389 [info ] [MainThread]: 
[0m23:32:24.493347 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m23:32:24.494339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70d76b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70e33160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70d3e2f0>]}
[0m23:32:24.495225 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 23:32:58.592564 | ea065cf4-d7c2-4a38-b30d-b593961f6085 ==============================
[0m23:32:58.592564 [info ] [MainThread]: Running with dbt=1.4.7
[0m23:32:58.595656 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:32:58.597292 [debug] [MainThread]: Tracking: tracking
[0m23:32:58.600540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f1c44ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f1c47010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f1c44a60>]}
[0m23:32:58.626900 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m23:32:59.205332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:59.207051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:59.214694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f02fff40>]}
[0m23:32:59.258619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f02c5f00>]}
[0m23:32:59.261936 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:32:59.264387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f36fe620>]}
[0m23:32:59.269684 [info ] [MainThread]: 
[0m23:32:59.273461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:59.276659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:32:59.295415 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:32:59.298921 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:32:59.301963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:59.333731 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m23:32:59.336919 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:32:59.340653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m23:32:59.348145 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:32:59.349312 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:32:59.350994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:59.369952 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:32:59.371709 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:32:59.373299 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:32:59.379825 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m23:32:59.383140 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:32:59.386930 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:32:59.396603 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:59.398364 [debug] [MainThread]: On master: BEGIN
[0m23:32:59.399633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:59.418515 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:59.420142 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:59.421536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:59.430562 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:32:59.433377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f033f850>]}
[0m23:32:59.435387 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:59.439718 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:59.441402 [debug] [MainThread]: On master: BEGIN
[0m23:32:59.448344 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:59.450357 [debug] [MainThread]: On master: COMMIT
[0m23:32:59.452313 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:59.454570 [debug] [MainThread]: On master: COMMIT
[0m23:32:59.460235 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:32:59.461962 [debug] [MainThread]: On master: Close
[0m23:32:59.464559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:59.466666 [info ] [MainThread]: 
[0m23:32:59.474076 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:32:59.476278 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:32:59.479231 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m23:32:59.480630 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:32:59.486325 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:32:59.515797 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 23:32:59.482146 => 2024-02-25 23:32:59.515585
[0m23:32:59.519795 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:32:59.570235 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:32:59.587728 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:59.588697 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:32:59.589475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:59.601712 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:32:59.602884 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:59.603793 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:32:59.612797 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:32:59.621146 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:59.622693 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m23:32:59.625788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:59.629751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:59.630452 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m23:32:59.633289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:59.657350 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:32:59.660653 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:59.662667 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:32:59.672103 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:32:59.680165 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:32:59.682364 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m23:32:59.691144 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:32:59.694075 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 23:32:59.522599 => 2024-02-25 23:32:59.694013
[0m23:32:59.695604 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:32:59.697963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f0161bd0>]}
[0m23:32:59.699572 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.22s]
[0m23:32:59.702598 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:32:59.704435 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:32:59.706098 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:32:59.707821 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m23:32:59.709131 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:32:59.716972 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:32:59.743453 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 23:32:59.710693 => 2024-02-25 23:32:59.743310
[0m23:32:59.746223 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:32:59.753474 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:32:59.785531 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:59.788733 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:32:59.791815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:59.822788 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:32:59.825763 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:59.828905 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:32:59.849002 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:32:59.854544 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:59.857286 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m23:32:59.862777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:59.867655 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:59.869574 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m23:32:59.874914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:59.878508 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:32:59.880077 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:59.881506 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:32:59.888094 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:32:59.892284 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:32:59.893584 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m23:32:59.900235 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:32:59.903485 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 23:32:59.748988 => 2024-02-25 23:32:59.903413
[0m23:32:59.905458 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:32:59.908030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f033d480>]}
[0m23:32:59.910632 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.20s]
[0m23:32:59.913059 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:32:59.915241 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:32:59.917495 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:32:59.919971 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m23:32:59.922091 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:32:59.929421 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:32:59.953317 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 23:32:59.923894 => 2024-02-25 23:32:59.953106
[0m23:32:59.956816 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:32:59.968604 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:33:00.001951 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:33:00.004803 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:33:00.007892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:00.042576 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:33:00.047065 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:33:00.049852 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:33:00.066611 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:33:00.073489 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:33:00.076696 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m23:33:00.085277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:33:00.091834 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:33:00.093704 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m23:33:00.099504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:33:00.104175 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:33:00.105477 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:33:00.107141 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:33:00.114477 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:33:00.120514 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:33:00.122760 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m23:33:00.133275 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:33:00.137460 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 23:32:59.960946 => 2024-02-25 23:33:00.137366
[0m23:33:00.139924 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:33:00.143477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f0218f10>]}
[0m23:33:00.146097 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.22s]
[0m23:33:00.147932 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:33:00.151171 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:33:00.153257 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m23:33:00.156007 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m23:33:00.157485 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m23:33:00.163904 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m23:33:00.180497 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 23:33:00.158805 => 2024-02-25 23:33:00.180308
[0m23:33:00.182717 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m23:33:00.189025 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m23:33:00.210286 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:33:00.211361 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m23:33:00.212363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:00.226213 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:33:00.227467 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:33:00.228245 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE 
        WHEN user_rating >= 4.5 THEN 'EXCELLENT' 
        WHEN user_rating >= 4.0 THEN 'GOOD' 
        WHEN user_rating >= 3.0 THEN 'AVERAGE' 
        ELSE 'POOR'
    END as rating_category    
  FROM "destination_db"."public"."films"
),


films_with_actors AS (
    SELECT 
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title   
)


SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors  fwa ON fwf.film_id = fwa.film_id
  );
  
[0m23:33:00.246924 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:33:00.251337 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:33:00.252789 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m23:33:00.260897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:33:00.264910 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:33:00.266759 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:33:00.268673 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:33:00.278879 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:33:00.283666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:33:00.285447 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m23:33:00.290988 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:33:00.293504 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 23:33:00.184321 => 2024-02-25 23:33:00.293442
[0m23:33:00.295304 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m23:33:00.297175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea065cf4-d7c2-4a38-b30d-b593961f6085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f02e95d0>]}
[0m23:33:00.298700 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.14s]
[0m23:33:00.300012 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:33:00.302949 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:33:00.304456 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:00.306230 [debug] [MainThread]: On master: BEGIN
[0m23:33:00.308388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:00.324232 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:33:00.325661 [debug] [MainThread]: On master: COMMIT
[0m23:33:00.326759 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:00.327653 [debug] [MainThread]: On master: COMMIT
[0m23:33:00.330157 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:33:00.331058 [debug] [MainThread]: On master: Close
[0m23:33:00.332252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:00.333078 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m23:33:00.334044 [info ] [MainThread]: 
[0m23:33:00.335112 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m23:33:00.336498 [debug] [MainThread]: Command end result
[0m23:33:00.374920 [info ] [MainThread]: 
[0m23:33:00.377190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:00.378368 [info ] [MainThread]: 
[0m23:33:00.379923 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:33:00.381537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f034c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f034ef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f034e7d0>]}
[0m23:33:00.382993 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 23:47:53.781015 | 5b3a78c3-ddeb-44d5-9f66-6ec1a762df42 ==============================
[0m23:47:53.781015 [info ] [MainThread]: Running with dbt=1.4.7
[0m23:47:53.784417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:47:53.786385 [debug] [MainThread]: Tracking: tracking
[0m23:47:53.789708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cd7490f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cd7497b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cd749390>]}
[0m23:47:53.816169 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m23:47:54.206164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:47:54.208036 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_movie.sql
[0m23:47:54.230415 [debug] [MainThread]: 1603: static parser failed on example/specific_movie.sql
[0m23:47:54.249110 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/specific_movie.sql
[0m23:47:54.271059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b3a78c3-ddeb-44d5-9f66-6ec1a762df42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbce9b40>]}
[0m23:47:54.298799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b3a78c3-ddeb-44d5-9f66-6ec1a762df42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbe87670>]}
[0m23:47:54.300256 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:47:54.302047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b3a78c3-ddeb-44d5-9f66-6ec1a762df42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbe860b0>]}
[0m23:47:54.305263 [info ] [MainThread]: 
[0m23:47:54.308315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:54.310635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:47:54.323763 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:47:54.325882 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:47:54.327948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:54.348321 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m23:47:54.351101 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:47:54.354631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m23:47:54.361674 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:47:54.363250 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:47:54.364629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:54.381045 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:47:54.382242 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:47:54.383061 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:47:54.387626 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m23:47:54.390010 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:47:54.392613 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:47:54.398918 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:54.400319 [debug] [MainThread]: On master: BEGIN
[0m23:47:54.401507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:54.415897 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:54.417144 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:54.418097 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:54.425288 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:47:54.427143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b3a78c3-ddeb-44d5-9f66-6ec1a762df42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbd0bfa0>]}
[0m23:47:54.428127 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:54.431073 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:54.432345 [debug] [MainThread]: On master: BEGIN
[0m23:47:54.436802 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:54.437892 [debug] [MainThread]: On master: COMMIT
[0m23:47:54.438824 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:54.439636 [debug] [MainThread]: On master: COMMIT
[0m23:47:54.441707 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:54.442457 [debug] [MainThread]: On master: Close
[0m23:47:54.443671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:47:54.444589 [info ] [MainThread]: 
[0m23:47:54.460732 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:47:54.463148 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m23:47:54.465116 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m23:47:54.466609 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:47:54.470736 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:47:54.483268 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 23:47:54.467785 => 2024-02-25 23:47:54.483089
[0m23:47:54.484963 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:47:54.532321 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:47:54.558209 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:47:54.559565 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:47:54.561027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:54.575381 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:47:54.576679 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:47:54.577480 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:47:54.580411 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m23:47:54.581515 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m23:47:54.584223 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 23:47:54.486635 => 2024-02-25 23:47:54.584119
[0m23:47:54.585202 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:47:54.589993 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:47:54.591660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b3a78c3-ddeb-44d5-9f66-6ec1a762df42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbd92da0>]}
[0m23:47:54.593316 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m23:47:54.599728 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:47:54.601254 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:47:54.603039 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m23:47:54.606111 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m23:47:54.607696 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:47:54.612584 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:47:54.623690 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 23:47:54.608681 => 2024-02-25 23:47:54.623538
[0m23:47:54.625034 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:47:54.631002 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:47:54.647551 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:47:54.648752 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:47:54.649979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:54.665314 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:47:54.666865 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:47:54.667689 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:47:54.670501 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m23:47:54.671586 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m23:47:54.673936 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 23:47:54.626143 => 2024-02-25 23:47:54.673844
[0m23:47:54.674744 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:47:54.676710 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:47:54.678054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b3a78c3-ddeb-44d5-9f66-6ec1a762df42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbd8efb0>]}
[0m23:47:54.679171 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m23:47:54.680449 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:47:54.681573 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:47:54.682596 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m23:47:54.684074 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m23:47:54.684931 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:47:54.688855 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:47:54.697642 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 23:47:54.685710 => 2024-02-25 23:47:54.697530
[0m23:47:54.699247 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:47:54.704527 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:47:54.713974 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:47:54.715036 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:47:54.716808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:54.733926 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:47:54.735071 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:47:54.736379 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:47:54.738741 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m23:47:54.739709 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m23:47:54.742248 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 23:47:54.700247 => 2024-02-25 23:47:54.742164
[0m23:47:54.743148 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:47:54.744571 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:47:54.745825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b3a78c3-ddeb-44d5-9f66-6ec1a762df42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbce8fa0>]}
[0m23:47:54.746914 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m23:47:54.748014 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:47:54.749769 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:47:54.750613 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m23:47:54.751638 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:47:54.752675 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m23:47:54.753587 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.specific_movie ..................................... [[33mSKIP[0m]
[0m23:47:54.754708 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m23:47:54.756864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:54.757791 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:54.758543 [debug] [MainThread]: On master: BEGIN
[0m23:47:54.759154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:54.772575 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:54.773751 [debug] [MainThread]: On master: COMMIT
[0m23:47:54.774560 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:54.775273 [debug] [MainThread]: On master: COMMIT
[0m23:47:54.777397 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:54.778252 [debug] [MainThread]: On master: Close
[0m23:47:54.779508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:54.780367 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m23:47:54.781262 [info ] [MainThread]: 
[0m23:47:54.782254 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m23:47:54.783343 [debug] [MainThread]: Command end result
[0m23:47:54.801333 [info ] [MainThread]: 
[0m23:47:54.802629 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m23:47:54.803955 [info ] [MainThread]: 
[0m23:47:54.805212 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m23:47:54.806119 [error] [MainThread]:   relation "public.actors" does not exist
[0m23:47:54.806974 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m23:47:54.807836 [error] [MainThread]:                             ^
[0m23:47:54.808764 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m23:47:54.809624 [info ] [MainThread]: 
[0m23:47:54.810539 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m23:47:54.811604 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m23:47:54.812500 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m23:47:54.813428 [error] [MainThread]:                             ^
[0m23:47:54.814368 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:47:54.815558 [info ] [MainThread]: 
[0m23:47:54.816630 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m23:47:54.817530 [error] [MainThread]:   relation "public.films" does not exist
[0m23:47:54.818656 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m23:47:54.819644 [error] [MainThread]:                             ^
[0m23:47:54.820800 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m23:47:54.821953 [info ] [MainThread]: 
[0m23:47:54.823034 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m23:47:54.823984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cd749ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbd8caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbd9e320>]}
[0m23:47:54.824910 [debug] [MainThread]: Flushing usage events


============================== 2024-02-25 23:53:31.101541 | b3d6952e-60dd-43bd-86f7-61f5feb1b1bf ==============================
[0m23:53:31.101541 [info ] [MainThread]: Running with dbt=1.4.7
[0m23:53:31.104768 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:53:31.106431 [debug] [MainThread]: Tracking: tracking
[0m23:53:31.109510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0494520b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0494523040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0494520af0>]}
[0m23:53:31.132587 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m23:53:31.527986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:53:31.530663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:53:31.542612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492bd8ca0>]}
[0m23:53:31.599022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492b9a290>]}
[0m23:53:31.601731 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:53:31.603940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0495eadb70>]}
[0m23:53:31.608410 [info ] [MainThread]: 
[0m23:53:31.611727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:31.614749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:53:31.629406 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:53:31.631605 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:53:31.633551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:31.660609 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m23:53:31.664103 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:53:31.669260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m23:53:31.682838 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:53:31.685698 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:53:31.688477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:31.714193 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:53:31.715264 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:53:31.716281 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:53:31.721094 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m23:53:31.723829 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:53:31.726609 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:53:31.734356 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:31.735320 [debug] [MainThread]: On master: BEGIN
[0m23:53:31.736279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:31.751393 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:53:31.753541 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:31.755182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:53:31.764123 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:53:31.766291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492c1b850>]}
[0m23:53:31.767659 [debug] [MainThread]: On master: ROLLBACK
[0m23:53:31.770493 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:31.771457 [debug] [MainThread]: On master: BEGIN
[0m23:53:31.775549 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:53:31.776504 [debug] [MainThread]: On master: COMMIT
[0m23:53:31.777753 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:31.779042 [debug] [MainThread]: On master: COMMIT
[0m23:53:31.782805 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:53:31.784031 [debug] [MainThread]: On master: Close
[0m23:53:31.785519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:31.786830 [info ] [MainThread]: 
[0m23:53:31.791520 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:53:31.792658 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m23:53:31.794233 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m23:53:31.795188 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:53:31.798669 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:53:31.808774 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-25 23:53:31.795954 => 2024-02-25 23:53:31.808617
[0m23:53:31.809963 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:53:31.858066 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:53:31.884121 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:31.886166 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:53:31.888266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:31.908124 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:53:31.909081 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:31.909716 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:53:31.919681 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:53:31.927666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:31.929491 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m23:53:31.933917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:31.937866 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:31.940212 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m23:53:31.945653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:31.974908 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:53:31.976660 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:31.978306 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:53:31.988184 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:53:31.994547 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:31.996179 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m23:53:32.006302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:53:32.009058 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-25 23:53:31.811305 => 2024-02-25 23:53:32.008994
[0m23:53:32.010598 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:53:32.012681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492a39bd0>]}
[0m23:53:32.014696 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.22s]
[0m23:53:32.017527 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:53:32.019032 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:53:32.020257 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m23:53:32.021985 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m23:53:32.023129 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:53:32.027108 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:53:32.039049 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-25 23:53:32.024399 => 2024-02-25 23:53:32.038918
[0m23:53:32.040043 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:53:32.045205 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:53:32.055666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:32.056798 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:53:32.058288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:32.072052 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:53:32.073292 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:32.074101 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:53:32.089945 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:53:32.098869 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:32.100298 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m23:53:32.107778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:32.114801 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:32.115769 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m23:53:32.123165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:32.126473 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:53:32.127580 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:32.128861 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:53:32.138181 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:53:32.143835 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:32.145213 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m23:53:32.152641 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:53:32.156592 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-25 23:53:32.040946 => 2024-02-25 23:53:32.156525
[0m23:53:32.157704 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:53:32.159555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492c1b9d0>]}
[0m23:53:32.161239 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.14s]
[0m23:53:32.162380 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:53:32.163810 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:53:32.165393 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m23:53:32.166923 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m23:53:32.168124 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:53:32.173363 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:53:32.195584 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-25 23:53:32.169124 => 2024-02-25 23:53:32.195395
[0m23:53:32.197108 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:53:32.208527 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:53:32.237175 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:32.239857 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:53:32.241161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:32.259973 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:53:32.260989 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:32.262110 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:53:32.274930 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:53:32.279058 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:32.279856 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m23:53:32.282601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:32.290686 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:32.295028 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m23:53:32.300441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:32.307347 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:53:32.310481 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:32.312351 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:53:32.322025 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:53:32.330908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:32.332778 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m23:53:32.341220 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:53:32.344427 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-25 23:53:32.198204 => 2024-02-25 23:53:32.344366
[0m23:53:32.346074 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:53:32.348377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492a88670>]}
[0m23:53:32.349814 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.18s]
[0m23:53:32.351387 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:53:32.354482 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:53:32.355819 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m23:53:32.357462 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m23:53:32.358654 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m23:53:32.363380 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m23:53:32.376309 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-25 23:53:32.359705 => 2024-02-25 23:53:32.375664
[0m23:53:32.378901 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m23:53:32.385227 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m23:53:32.414043 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:53:32.417257 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m23:53:32.419542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:32.446429 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:53:32.448296 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:53:32.450185 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE 
        WHEN user_rating >= 4.5 THEN 'EXCELLENT' 
        WHEN user_rating >= 4.0 THEN 'GOOD' 
        WHEN user_rating >= 3.0 THEN 'AVERAGE' 
        ELSE 'POOR'
    END as rating_category    
  FROM "destination_db"."public"."films"
),


films_with_actors AS (
    SELECT 
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title   
)


SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors  fwa ON fwf.film_id = fwa.film_id
  );
  
[0m23:53:32.476629 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:53:32.482097 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:53:32.483694 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m23:53:32.493116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:32.499724 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:53:32.502776 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:53:32.506036 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:53:32.519751 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:53:32.529892 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:53:32.533184 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m23:53:32.541093 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:53:32.544721 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-25 23:53:32.380370 => 2024-02-25 23:53:32.544641
[0m23:53:32.545994 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m23:53:32.547727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492b17e80>]}
[0m23:53:32.549311 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.19s]
[0m23:53:32.550564 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:53:32.551678 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m23:53:32.553213 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m23:53:32.555051 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m23:53:32.555768 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m23:53:32.560948 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m23:53:32.578042 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-02-25 23:53:32.556569 => 2024-02-25 23:53:32.577433
[0m23:53:32.582429 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m23:53:32.596468 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m23:53:32.627954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m23:53:32.631153 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m23:53:32.633586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:32.658847 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:53:32.660787 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m23:53:32.662390 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    


SELECT * 
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m23:53:32.677096 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m23:53:32.682988 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m23:53:32.685018 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m23:53:32.693773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:32.698175 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m23:53:32.700088 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m23:53:32.701989 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m23:53:32.711913 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:53:32.719515 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m23:53:32.724301 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m23:53:32.731772 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:53:32.735071 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-02-25 23:53:32.584098 => 2024-02-25 23:53:32.734982
[0m23:53:32.736905 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m23:53:32.740021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d6952e-60dd-43bd-86f7-61f5feb1b1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0490910fa0>]}
[0m23:53:32.742462 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.19s]
[0m23:53:32.744087 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m23:53:32.747093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:32.749113 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:32.750728 [debug] [MainThread]: On master: BEGIN
[0m23:53:32.752569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:32.773952 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:53:32.777424 [debug] [MainThread]: On master: COMMIT
[0m23:53:32.779102 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:32.780824 [debug] [MainThread]: On master: COMMIT
[0m23:53:32.786195 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:53:32.789369 [debug] [MainThread]: On master: Close
[0m23:53:32.793231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:32.795752 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m23:53:32.799670 [info ] [MainThread]: 
[0m23:53:32.802925 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m23:53:32.806042 [debug] [MainThread]: Command end result
[0m23:53:32.859200 [info ] [MainThread]: 
[0m23:53:32.860564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:32.862134 [info ] [MainThread]: 
[0m23:53:32.863585 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:53:32.865098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492c0f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0490910fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0492a27ee0>]}
[0m23:53:32.866816 [debug] [MainThread]: Flushing usage events


============================== 2024-02-26 02:54:26.007642 | 59540b0b-9e6f-4fbd-a95c-7735cd882b5a ==============================
[0m02:54:26.007642 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:54:26.014740 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:54:26.019808 [debug] [MainThread]: Tracking: tracking
[0m02:54:26.033125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee30df0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee30df3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee30df0a60>]}
[0m02:54:26.077913 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:54:26.882848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:54:26.885588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:54:26.900826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59540b0b-9e6f-4fbd-a95c-7735cd882b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2f4accd0>]}
[0m02:54:26.956739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59540b0b-9e6f-4fbd-a95c-7735cd882b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2f46e2c0>]}
[0m02:54:26.959405 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:54:26.961289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59540b0b-9e6f-4fbd-a95c-7735cd882b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee32876620>]}
[0m02:54:26.966444 [info ] [MainThread]: 
[0m02:54:26.970056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:54:26.973543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:54:26.994742 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:54:26.998260 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:54:27.001016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:27.038928 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m02:54:27.052676 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:54:27.060172 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:54:27.064592 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m02:54:27.070442 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:54:27.079954 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m02:54:27.085498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:27.088831 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m02:54:27.096032 [info ] [MainThread]: 
[0m02:54:27.103383 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m02:54:27.115882 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m02:54:27.119255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2f46ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2f2ef970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2f2efa60>]}
[0m02:54:27.122831 [debug] [MainThread]: Flushing usage events


============================== 2024-02-26 02:54:34.561113 | 0b93d764-64e8-484b-9bf4-45e627df7d4a ==============================
[0m02:54:34.561113 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:54:34.567432 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:54:34.570382 [debug] [MainThread]: Tracking: tracking
[0m02:54:34.576986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1235b8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1235bb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1235b8a60>]}
[0m02:54:34.630042 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:54:35.503725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:54:35.505898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:54:35.515769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121c70cd0>]}
[0m02:54:35.564380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121c362c0>]}
[0m02:54:35.566817 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:54:35.569006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe125066620>]}
[0m02:54:35.572284 [info ] [MainThread]: 
[0m02:54:35.575956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:54:35.579592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:54:35.617583 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:54:35.621160 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:54:35.624625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:35.697527 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m02:54:35.702932 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:54:35.709565 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:54:35.724708 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:54:35.727667 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:54:35.731051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:35.764626 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:54:35.767045 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:54:35.769516 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:54:35.798507 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m02:54:35.863048 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:54:35.896821 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:54:35.967793 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:35.972238 [debug] [MainThread]: On master: BEGIN
[0m02:54:35.975626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:36.022821 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:54:36.026357 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:36.029202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:54:36.064739 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:54:36.070132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121cb7850>]}
[0m02:54:36.073541 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:36.097610 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:36.141983 [debug] [MainThread]: On master: BEGIN
[0m02:54:36.188831 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:54:36.191527 [debug] [MainThread]: On master: COMMIT
[0m02:54:36.194366 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:36.197269 [debug] [MainThread]: On master: COMMIT
[0m02:54:36.204510 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:54:36.207229 [debug] [MainThread]: On master: Close
[0m02:54:36.210396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:54:36.213704 [info ] [MainThread]: 
[0m02:54:36.225144 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:54:36.228710 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m02:54:36.232094 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:54:36.234127 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:54:36.241116 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:54:36.280149 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-26 02:54:36.235823 => 2024-02-26 02:54:36.279871
[0m02:54:36.283151 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:54:36.352044 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:54:36.382893 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:54:36.385401 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:54:36.388460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:36.427242 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:54:36.430365 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:54:36.433447 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m02:54:36.463676 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:54:36.482472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:54:36.485594 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m02:54:36.494304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:36.513433 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:54:36.521486 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m02:54:36.551112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:36.618085 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:54:36.621599 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:54:36.624911 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:54:36.643170 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:54:36.660964 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:54:36.664626 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m02:54:36.681121 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:54:36.687105 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-26 02:54:36.285876 => 2024-02-26 02:54:36.686959
[0m02:54:36.690633 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:54:36.695155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121ae10c0>]}
[0m02:54:36.701080 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.46s]
[0m02:54:36.708839 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:54:36.712152 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:54:36.715291 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m02:54:36.719103 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:54:36.721881 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:54:36.730878 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:54:36.767890 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-26 02:54:36.724374 => 2024-02-26 02:54:36.767624
[0m02:54:36.771459 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:54:36.790031 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:54:36.830104 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:54:36.832921 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:54:36.836029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:36.877531 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:54:36.880906 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:54:36.883814 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m02:54:36.907396 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:54:36.917196 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:54:36.920366 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m02:54:36.930775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:36.940113 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:54:36.943174 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m02:54:36.951605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:36.959999 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:54:36.962762 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:54:36.965627 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:54:36.978112 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:54:36.986959 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:54:36.990099 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m02:54:37.002862 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:54:37.008827 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-26 02:54:36.774812 => 2024-02-26 02:54:37.008712
[0m02:54:37.012254 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:54:37.017024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121c341f0>]}
[0m02:54:37.021146 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.30s]
[0m02:54:37.024698 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:54:37.027862 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:54:37.031301 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m02:54:37.034629 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:54:37.037574 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:54:37.049975 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:54:37.089358 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-26 02:54:37.041312 => 2024-02-26 02:54:37.089174
[0m02:54:37.092576 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:54:37.103109 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:54:37.139046 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:54:37.142082 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:54:37.145002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:37.178910 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:54:37.181299 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:54:37.185497 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m02:54:37.216247 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:54:37.225289 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:54:37.230486 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m02:54:37.246889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:37.255891 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:54:37.263139 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m02:54:37.272238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:37.282291 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:54:37.285778 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:54:37.288613 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:54:37.302631 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:54:37.310636 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:54:37.314100 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m02:54:37.328696 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:54:37.334693 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-26 02:54:37.095776 => 2024-02-26 02:54:37.334555
[0m02:54:37.337714 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:54:37.341802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121b91030>]}
[0m02:54:37.344905 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.31s]
[0m02:54:37.347826 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:54:37.352784 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:54:37.356647 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m02:54:37.361033 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m02:54:37.364351 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m02:54:37.375430 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m02:54:37.415905 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-26 02:54:37.367197 => 2024-02-26 02:54:37.415712
[0m02:54:37.419110 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m02:54:37.431045 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m02:54:37.481013 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:54:37.526477 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m02:54:37.529178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:37.608605 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:54:37.617067 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:54:37.624467 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE 
        WHEN user_rating >= 4.5 THEN 'EXCELLENT' 
        WHEN user_rating >= 4.0 THEN 'GOOD' 
        WHEN user_rating >= 3.0 THEN 'AVERAGE' 
        ELSE 'POOR'
    END as rating_category    
  FROM "destination_db"."public"."films"
),


films_with_actors AS (
    SELECT 
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title   
)


SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors  fwa ON fwf.film_id = fwa.film_id
  );
  
[0m02:54:37.671294 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:54:37.679998 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:54:37.682595 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m02:54:37.689865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:37.696992 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:54:37.700378 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m02:54:37.709818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:37.718862 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:54:37.721365 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:54:37.724067 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:54:37.738380 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:54:37.749714 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:54:37.752442 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m02:54:37.765705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:54:37.771559 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-26 02:54:37.422212 => 2024-02-26 02:54:37.771441
[0m02:54:37.774572 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m02:54:37.778823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121b8d780>]}
[0m02:54:37.782359 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.42s]
[0m02:54:37.787102 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:54:37.791085 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m02:54:37.794962 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m02:54:37.802381 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m02:54:37.806582 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m02:54:37.818932 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m02:54:37.854609 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-02-26 02:54:37.810074 => 2024-02-26 02:54:37.854092
[0m02:54:37.859008 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m02:54:37.882297 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m02:54:37.919257 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m02:54:37.922527 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m02:54:37.927356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:37.978752 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:54:37.984403 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m02:54:37.987470 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    


SELECT * 
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m02:54:38.010791 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m02:54:38.025290 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m02:54:38.028163 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m02:54:38.035669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:38.043912 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m02:54:38.045998 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m02:54:38.052641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:54:38.057727 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m02:54:38.059751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m02:54:38.061473 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m02:54:38.071019 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:54:38.079006 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m02:54:38.082945 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m02:54:38.097409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:54:38.103329 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-02-26 02:54:37.862659 => 2024-02-26 02:54:38.103184
[0m02:54:38.107033 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m02:54:38.110445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b93d764-64e8-484b-9bf4-45e627df7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121b8e200>]}
[0m02:54:38.116322 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 2[0m in 0.31s]
[0m02:54:38.120723 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m02:54:38.127300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:54:38.132802 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:38.136366 [debug] [MainThread]: On master: BEGIN
[0m02:54:38.139424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:38.192965 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:54:38.197795 [debug] [MainThread]: On master: COMMIT
[0m02:54:38.202157 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:38.205690 [debug] [MainThread]: On master: COMMIT
[0m02:54:38.217247 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:54:38.221557 [debug] [MainThread]: On master: Close
[0m02:54:38.227799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:38.236309 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m02:54:38.240735 [info ] [MainThread]: 
[0m02:54:38.243965 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m02:54:38.252522 [debug] [MainThread]: Command end result
[0m02:54:38.299302 [info ] [MainThread]: 
[0m02:54:38.303048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:54:38.306813 [info ] [MainThread]: 
[0m02:54:38.310101 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m02:54:38.313597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121cbceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121ae2a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe121ae2800>]}
[0m02:54:38.317300 [debug] [MainThread]: Flushing usage events


============================== 2024-02-27 15:15:55.080696 | bf3df8b4-12db-4953-b5c5-589e5179891f ==============================
[0m15:15:55.080696 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:15:55.085014 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/opt/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:15:55.086454 [debug] [MainThread]: Tracking: tracking
[0m15:15:55.101521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601f965360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601f9657e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601f9653c0>]}
[0m15:15:55.124124 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:15:55.655874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:55.657978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:55.675180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601e098df0>]}
[0m15:15:55.725318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601e1de410>]}
[0m15:15:55.727553 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:15:55.730227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601e1de470>]}
[0m15:15:55.736111 [info ] [MainThread]: 
[0m15:15:55.742564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:15:55.747638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:15:55.767294 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:15:55.769973 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:15:55.772270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:55.819036 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:15:55.822702 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:15:55.826899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:15:55.835010 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:15:55.837084 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:15:55.838869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:55.855629 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:15:55.857522 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:15:55.859041 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:15:55.865098 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m15:15:55.868275 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:15:55.872542 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:15:55.883380 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:55.885334 [debug] [MainThread]: On master: BEGIN
[0m15:15:55.887438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:55.914301 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:15:55.916634 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:55.918363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:55.943545 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:15:55.949002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601e0cd060>]}
[0m15:15:55.952065 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:55.959571 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:55.962274 [debug] [MainThread]: On master: BEGIN
[0m15:15:55.971750 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:15:55.974118 [debug] [MainThread]: On master: COMMIT
[0m15:15:55.976077 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:55.978168 [debug] [MainThread]: On master: COMMIT
[0m15:15:55.984290 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:15:55.986304 [debug] [MainThread]: On master: Close
[0m15:15:55.988999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:55.991425 [info ] [MainThread]: 
[0m15:15:56.013143 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m15:15:56.015196 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m15:15:56.017526 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m15:15:56.019335 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m15:15:56.023689 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m15:15:56.041832 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-02-27 15:15:56.020796 => 2024-02-27 15:15:56.041703
[0m15:15:56.043395 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m15:15:56.085787 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m15:15:56.105738 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:15:56.107888 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m15:15:56.110026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:56.132378 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:15:56.133865 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:15:56.135368 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:15:56.139855 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:15:56.150065 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:15:56.151828 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m15:15:56.156041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.160257 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:15:56.161934 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:15:56.166733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.200833 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m15:15:56.203689 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:15:56.206051 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m15:15:56.215227 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:15:56.224719 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:15:56.227196 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m15:15:56.240334 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:15:56.245449 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-02-27 15:15:56.044759 => 2024-02-27 15:15:56.245348
[0m15:15:56.247565 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m15:15:56.251233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601df592a0>]}
[0m15:15:56.253737 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.23s]
[0m15:15:56.259290 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m15:15:56.261322 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m15:15:56.263304 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m15:15:56.266433 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m15:15:56.269470 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m15:15:56.277334 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m15:15:56.302325 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-02-27 15:15:56.271675 => 2024-02-27 15:15:56.302098
[0m15:15:56.304598 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m15:15:56.316072 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m15:15:56.341108 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:15:56.343399 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m15:15:56.345679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:56.370916 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:15:56.372496 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:15:56.373929 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:15:56.378538 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:15:56.382533 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:15:56.383928 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m15:15:56.388456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.392536 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:15:56.393825 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:15:56.397442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.400523 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m15:15:56.401889 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:15:56.403222 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m15:15:56.409245 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:15:56.414710 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:15:56.416365 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m15:15:56.423259 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:15:56.426469 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-02-27 15:15:56.306883 => 2024-02-27 15:15:56.426395
[0m15:15:56.428086 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m15:15:56.430541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601dfcc0d0>]}
[0m15:15:56.432607 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.16s]
[0m15:15:56.434305 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m15:15:56.436334 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m15:15:56.438242 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m15:15:56.440654 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m15:15:56.442233 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m15:15:56.447274 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m15:15:56.469402 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-02-27 15:15:56.443699 => 2024-02-27 15:15:56.469203
[0m15:15:56.472096 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m15:15:56.482705 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m15:15:56.509760 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:15:56.511657 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m15:15:56.513622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:56.540949 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:15:56.542821 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:15:56.544539 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:15:56.551084 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:15:56.558170 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:15:56.560499 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m15:15:56.566869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.573975 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:15:56.575887 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:15:56.582789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.589401 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m15:15:56.591990 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:15:56.594199 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m15:15:56.604341 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:15:56.611526 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:15:56.613409 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m15:15:56.623085 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:15:56.626632 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-02-27 15:15:56.474548 => 2024-02-27 15:15:56.626558
[0m15:15:56.628416 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m15:15:56.630991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601dfc4be0>]}
[0m15:15:56.633176 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.19s]
[0m15:15:56.635612 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m15:15:56.638535 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m15:15:56.640579 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m15:15:56.642823 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m15:15:56.644617 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m15:15:56.651384 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m15:15:56.672847 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-02-27 15:15:56.645998 => 2024-02-27 15:15:56.672634
[0m15:15:56.675159 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m15:15:56.686180 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m15:15:56.714699 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:15:56.716542 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m15:15:56.718363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:56.748251 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:15:56.750449 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:15:56.752471 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
  SELECT
    film_id,
    title,
    release_date,
    price,
    rating,
    user_rating,
    CASE 
        WHEN user_rating >= 4.5 THEN 'EXCELLENT' 
        WHEN user_rating >= 4.0 THEN 'GOOD' 
        WHEN user_rating >= 3.0 THEN 'AVERAGE' 
        ELSE 'POOR'
    END as rating_category    
  FROM "destination_db"."public"."films"
),


films_with_actors AS (
    SELECT 
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title   
)


SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors  fwa ON fwf.film_id = fwa.film_id
  );
  
[0m15:15:56.767065 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:15:56.771785 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:15:56.773503 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m15:15:56.777755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.782223 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m15:15:56.783750 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:15:56.785511 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m15:15:56.792440 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:15:56.796033 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:15:56.798573 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m15:15:56.802708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:15:56.805157 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-02-27 15:15:56.677247 => 2024-02-27 15:15:56.805104
[0m15:15:56.806249 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m15:15:56.807861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601c5e6f20>]}
[0m15:15:56.809403 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.17s]
[0m15:15:56.810871 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m15:15:56.812097 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m15:15:56.813272 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m15:15:56.814739 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m15:15:56.815866 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m15:15:56.819594 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m15:15:56.836617 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-02-27 15:15:56.816823 => 2024-02-27 15:15:56.836466
[0m15:15:56.838191 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m15:15:56.845571 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m15:15:56.862274 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:15:56.864089 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m15:15:56.865804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:56.889329 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:15:56.891302 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:15:56.893343 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    


SELECT * 
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m15:15:56.901806 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m15:15:56.909192 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:15:56.911370 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m15:15:56.917606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:15:56.923517 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m15:15:56.925708 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:15:56.927740 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m15:15:56.937702 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:15:56.944538 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:15:56.947151 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m15:15:56.954155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:15:56.958903 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-02-27 15:15:56.839841 => 2024-02-27 15:15:56.958801
[0m15:15:56.961160 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m15:15:56.964565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf3df8b4-12db-4953-b5c5-589e5179891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601dfdf340>]}
[0m15:15:56.967245 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.15s]
[0m15:15:56.969745 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m15:15:56.974172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:15:56.976050 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:56.977869 [debug] [MainThread]: On master: BEGIN
[0m15:15:56.979741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:57.005433 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:15:57.007604 [debug] [MainThread]: On master: COMMIT
[0m15:15:57.009525 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:57.011769 [debug] [MainThread]: On master: COMMIT
[0m15:15:57.017288 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:15:57.019661 [debug] [MainThread]: On master: Close
[0m15:15:57.022345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:57.024616 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m15:15:57.026659 [info ] [MainThread]: 
[0m15:15:57.028931 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m15:15:57.031637 [debug] [MainThread]: Command end result
[0m15:15:57.082139 [info ] [MainThread]: 
[0m15:15:57.084800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:57.086978 [info ] [MainThread]: 
[0m15:15:57.089325 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:15:57.092013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601dfdeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601dfdf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601e0db190>]}
[0m15:15:57.094604 [debug] [MainThread]: Flushing usage events
